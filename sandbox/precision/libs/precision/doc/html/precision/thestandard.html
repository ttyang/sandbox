<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Changes to the C and C++ standard</title>
<link rel="stylesheet" href=".././boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.77.1">
<link rel="home" href="../index.html" title="Floating-Point Typedefs Having Specified Widths - N3626">
<link rel="up" href="../index.html" title="Floating-Point Typedefs Having Specified Widths - N3626">
<link rel="prev" href="literals.html" title="Handling floating-point literals">
<link rel="next" href="cmathinterop.html" title="Interoperation with &lt;cmath&gt; and special functions">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="" width="180" height="90" src=".././images/boost.png"></td>
<td align="center"><a href="../../../../../../index.html">Home</a></td>
<td align="center"><a href="../../../../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="literals.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="cmathinterop.html"><img src="../images/next.png" alt="Next"></a>
</div>
<div class="section precision_thestandard">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="precision.thestandard"></a><a class="link" href="thestandard.html" title="Changes to the C and C++ standard">Changes to the C and C++ standard</a>
</h2></div></div></div>
<p>
      The proper place for defining the optional floating-point <code class="computeroutput"><span class="keyword">typedef</span></code>s
      having specified widths should be oriented along the lines of the current standard
      <code class="computeroutput"><span class="identifier">stdint</span><span class="special">.</span><span class="identifier">h</span></code> and <code class="computeroutput"><span class="special">&lt;</span><span class="identifier">cstdint</span><span class="special">&gt;</span></code>.
      Consider the existing specification of integer <code class="computeroutput"><span class="keyword">typedef</span></code>s
      having specified widths in C++11. A partial synopsis is shown below.
    </p>
<p>
      18.4 Integer types [cstdint]
    </p>
<p>
      18.4.1 Header &lt;cstdint&gt; synopsis [cstdint.syn]
    </p>
<pre class="programlisting"><span class="keyword">namespace</span> <span class="identifier">std</span>
<span class="special">{</span>
  <span class="keyword">typedef</span> <span class="keyword">signed</span> <span class="identifier">integer</span> <span class="identifier">type</span> <span class="identifier">int8_t</span><span class="special">;</span>  <span class="comment">// optional</span>
  <span class="keyword">typedef</span> <span class="keyword">signed</span> <span class="identifier">integer</span> <span class="identifier">type</span> <span class="identifier">int16_t</span><span class="special">;</span> <span class="comment">// optional</span>
  <span class="keyword">typedef</span> <span class="keyword">signed</span> <span class="identifier">integer</span> <span class="identifier">type</span> <span class="identifier">int32_t</span><span class="special">;</span> <span class="comment">// optional</span>
  <span class="keyword">typedef</span> <span class="keyword">signed</span> <span class="identifier">integer</span> <span class="identifier">type</span> <span class="identifier">int64_t</span><span class="special">;</span> <span class="comment">// optional</span>
<span class="special">}</span>

<span class="comment">// ... and the corresponding least and fast types.</span>
</pre>
<p>
      It is not immediately obvious where the optional floating-point <code class="computeroutput"><span class="keyword">typedef</span></code>s having specified widths should reside.
      One potential place is <code class="computeroutput"><span class="special">&lt;</span><span class="identifier">cstdint</span><span class="special">&gt;</span></code>. The <code class="computeroutput"><span class="keyword">int</span></code>,
      however, implies integer types. Here, we prefer the proposed new headers <code class="computeroutput"><span class="identifier">stdfloat</span><span class="special">.</span><span class="identifier">h</span></code> and <code class="computeroutput"><span class="special">&lt;</span><span class="identifier">cstdfloat</span><span class="special">&gt;</span></code>
      calling <code class="computeroutput"><span class="identifier">stdfloat</span><span class="special">.</span><span class="identifier">h</span></code>.
    </p>
<p>
      We propose the following changes to the C standard (and incorporated into the
      C++ by reference).
    </p>
<p>
      We propose to add a new header <code class="computeroutput"><span class="identifier">stdfloat</span><span class="special">.</span><span class="identifier">h</span></code> and <code class="computeroutput"><span class="special">&lt;</span><span class="identifier">cstdfloat</span><span class="special">&gt;</span></code> to the standard library. The header <code class="computeroutput"><span class="special">&lt;</span><span class="identifier">cstdfloat</span><span class="special">&gt;</span></code> should call <code class="computeroutput"><span class="identifier">stdfloat</span><span class="special">.</span><span class="identifier">h</span></code> which
      may contain optional floating-point <code class="computeroutput"><span class="keyword">typedef</span></code>s
      having specified widths included in the implementation and the corresponding
      C macros shown above.
    </p>
<p>
      Section 18.4 could be extended (with a new title) but for clarity a new section
      18.11 is proposed.
    </p>
<p>
      18.11 Floating-Point Types having Specified Widths
    </p>
<p>
      18.11.1 Header &lt;cstdfloat&gt; synopsis [cstdfloat.syn]
    </p>
<p>
      Header <code class="computeroutput"><span class="identifier">cstdfloat</span><span class="special">.</span><span class="identifier">h</span></code>
    </p>
<p>
      All implementations should define this header, even if none of the <code class="computeroutput"><span class="keyword">typedef</span></code>s are available, when it will be an empty
      file.
    </p>
<p>
      Only those <code class="computeroutput"><span class="keyword">typedef</span></code>s that are appropriate
      should be defined. For example, if a <code class="computeroutput"><span class="keyword">double</span></code>
      type is not in IEEE754 format, then <code class="computeroutput"><span class="keyword">typedef</span>
      <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span><span class="special">-</span><span class="identifier">type</span>
      <span class="identifier">float64_t</span></code> should <span class="bold"><strong>not</strong></span>
      be defined. This will ensure that programs that try to use a <code class="computeroutput"><span class="keyword">typedef</span></code> that is not defined on that platform
      will simply fail to compile.
    </p>
<p>
      <code class="computeroutput"><span class="keyword">typedef</span></code>s of the format <code class="computeroutput"><span class="identifier">floatN_t</span></code> are for IEE754 types (were available)
      providing exactly N bits. For these types that are defined, <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">numeric_limits</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">is_iec559</span> <span class="special">==</span> <span class="keyword">true</span></code>.
    </p>
<p>
      <code class="computeroutput"><span class="keyword">typedef</span></code>s of the format <code class="computeroutput"><span class="identifier">float_leastN_t</span></code> provide types with at least
      the precision N, but do <span class="bold"><strong>not</strong></span> specify the layout.
    </p>
<p>
      <code class="computeroutput"><span class="keyword">typedef</span></code>s of the format <code class="computeroutput"><span class="identifier">float_fastN_t</span></code> provide types with at least
      the precision N, and provide the fastest execution, and do <span class="bold"><strong>not</strong></span>
      specify the layout.
    </p>
<p>
      The use of denormals is implementation dependent, but can be determined for
      any type T from <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">numeric_limits</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">has_denorm</span><span class="special">,</span> <span class="identifier">denorm_min</span></code>
      and <code class="computeroutput"><span class="identifier">float_denorm_style</span></code>.
    </p>
<p>
      The endianness of the layout of the floating-point types is not specified here
      (though it may be possible to determine this - see note 9).
    </p>
<pre class="programlisting"><span class="keyword">namespace</span> <span class="identifier">std</span>
<span class="special">{</span>
  <span class="keyword">typedef</span> <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span> <span class="identifier">type</span> <span class="identifier">float8_t</span><span class="special">;</span>   <span class="comment">// optional (See note 1).</span>
  <span class="keyword">typedef</span> <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span> <span class="identifier">type</span> <span class="identifier">float16_t</span><span class="special">;</span>   <span class="comment">// optional (See note 2).</span>
  <span class="keyword">typedef</span> <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span> <span class="identifier">type</span> <span class="identifier">float24_t</span><span class="special">;</span>   <span class="comment">// optional (See note 3.</span>
  <span class="keyword">typedef</span> <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span> <span class="identifier">type</span> <span class="identifier">float32_t</span><span class="special">;</span>   <span class="comment">// optional (See note 4).</span>
  <span class="keyword">typedef</span> <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span> <span class="identifier">type</span> <span class="identifier">float64_t</span><span class="special">;</span>   <span class="comment">// optional (See note 5).</span>
  <span class="keyword">typedef</span> <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span> <span class="identifier">type</span> <span class="identifier">float80_t</span><span class="special">;</span>   <span class="comment">// optional (See note 6).</span>
  <span class="keyword">typedef</span> <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span> <span class="identifier">type</span> <span class="identifier">float128_t</span><span class="special">;</span>  <span class="comment">// optional (See note 7).</span>
  <span class="keyword">typedef</span> <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span> <span class="identifier">type</span> <span class="identifier">floatmax_t</span><span class="special">;</span>  <span class="comment">// optional (largest floating-point type available).</span>

  <span class="keyword">typedef</span> <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span> <span class="identifier">type</span> <span class="identifier">float_least16_t</span><span class="special">;</span>  <span class="comment">// optional.</span>
  <span class="keyword">typedef</span> <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span> <span class="identifier">type</span> <span class="identifier">float_least32_t</span><span class="special">;</span>  <span class="comment">// optional.</span>
  <span class="keyword">typedef</span> <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span> <span class="identifier">type</span> <span class="identifier">float_least64_t</span><span class="special">;</span>  <span class="comment">// optional.</span>
  <span class="keyword">typedef</span> <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span> <span class="identifier">type</span> <span class="identifier">float_least128_t</span><span class="special">;</span> <span class="comment">// optional.</span>

  <span class="keyword">typedef</span> <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span> <span class="identifier">type</span> <span class="identifier">float_fast16_t</span><span class="special">;</span>  <span class="comment">// optional.</span>
  <span class="keyword">typedef</span> <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span> <span class="identifier">type</span> <span class="identifier">float_fast32_t</span><span class="special">;</span>  <span class="comment">// optional.</span>
  <span class="keyword">typedef</span> <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span> <span class="identifier">type</span> <span class="identifier">float_fast64_t</span><span class="special">;</span>  <span class="comment">// optional.</span>
  <span class="keyword">typedef</span> <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span> <span class="identifier">type</span> <span class="identifier">float_fast80_t</span><span class="special">;</span>  <span class="comment">// optional.</span>
  <span class="keyword">typedef</span> <span class="identifier">floating</span><span class="special">-</span><span class="identifier">point</span> <span class="identifier">type</span> <span class="identifier">float_fast128_t</span><span class="special">;</span> <span class="comment">// optional.</span>
<span class="special">}</span>
</pre>
<p>
      Notes
    </p>
<p>
      1 There is no IEEE754/IEC559 specification for a 8-bit floating-point type,
      so the layout is implementation dependent. The type should occupy exactly 8
      bits to allow optimisation.
    </p>
<p>
      2 There is no IEEE754/IEC559 specification for a 24-bit floating-point type,
      so the layout is implementation dependent.
    </p>
<p>
      3 IEEE754 Half precision.
    </p>
<p>
      4 IEEE754 Single precision.
    </p>
<p>
      5 IEEE754 Double precision.
    </p>
<p>
      6 IEEE754 Extended precision. This type may be implemented using 128 bits,
      with padding. The size and location of any padding is implementation dependent,
      so this type is unlikely to be suitable for binary interchange.
    </p>
<p>
      7 IEEE754 Quadruple precision.
    </p>
<p>
      8 The use of denormals is implementation dependent, but can be determined for
      any type T from <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">numeric_limits</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">has_denorm</span><span class="special">,</span> <span class="identifier">denorm_min</span></code>
      and <code class="computeroutput"><span class="identifier">float_denorm_style</span></code>.
    </p>
<p>
      9 If cooperating programs wish to try to use binary interchange for IEEE754/IEC559
      types of <code class="computeroutput"><span class="identifier">float_N_t</span></code>, for example
      for serialization, because the endianness of the layout of the floating-point
      types is not specified (but may be determined) therefore programs must ensure
      that they all use the same endianness and the same use of denormals.
    </p>
<p>
      The header <code class="computeroutput"><span class="identifier">stdfloat</span><span class="special">.</span><span class="identifier">h</span></code> should also contain all necessary C function
      macros in the form shown below.
    </p>
<pre class="programlisting"><span class="identifier">FLOAT</span><span class="special">{</span><span class="number">16</span> <span class="number">32</span> <span class="number">64</span> <span class="number">80</span> <span class="number">128</span> <span class="identifier">MAX</span><span class="special">}</span><span class="identifier">_C</span>
</pre>
<p>
      The code below, for example, initializes a constant <code class="computeroutput"><span class="identifier">float128_t</span></code>
      value using one of these macros.
    </p>
<pre class="programlisting"><span class="error">`</span><span class="preprocessor">#include</span> <span class="identifier">cstdfloat</span><span class="special">.</span><span class="identifier">h</span><span class="error">`</span> <span class="keyword">or</span> <span class="error">`</span><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">cstdfloat</span><span class="special">&gt;</span><span class="error">`</span>

<span class="identifier">constexpr</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">float128_t</span> <span class="identifier">euler</span> <span class="special">=</span> <span class="identifier">FLOAT128_C</span><span class="special">(</span><span class="number">0.57721566490153286060651209008240243104216</span><span class="special">);</span>
</pre>
<p>
      The following code initializes a constant <code class="computeroutput"><span class="identifier">float16_t</span></code>
      value using another one of these macros.
    </p>
<pre class="programlisting"><span class="keyword">const</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">float16_t</span> <span class="identifier">euler</span> <span class="special">=</span> <span class="identifier">FLOAT16_C</span><span class="special">(</span><span class="number">0.577216</span><span class="special">);</span>
</pre>
<p>
      In addition, the header <code class="computeroutput"><span class="special">&lt;</span><span class="identifier">cstdfloat</span><span class="special">&gt;</span></code> should contain all necessary macros of
      the form:
    </p>
<pre class="programlisting"><span class="identifier">FLOAT_</span><span class="special">[</span><span class="identifier">FAST</span> <span class="identifier">LEAST</span><span class="special">]{</span><span class="number">16</span> <span class="number">32</span> <span class="number">64</span> <span class="number">80</span> <span class="number">128</span><span class="special">}</span><span class="identifier">_MIN</span>
<span class="identifier">FLOAT_</span><span class="special">[</span><span class="identifier">FAST</span> <span class="identifier">LEAST</span><span class="special">]{</span><span class="number">16</span> <span class="number">32</span> <span class="number">64</span> <span class="number">80</span> <span class="number">128</span><span class="special">}</span><span class="identifier">_MAX</span>
<span class="identifier">FLOATMAX_MIN</span>
<span class="identifier">FLOATMAX_MAX</span>
</pre>
<p>
      These macros can be used to query the ranges of the optional floating-point
      typedefs having specified widths at compile-time. For example,
    </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">limits</span><span class="special">&gt;</span>
<span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">cstdfloat</span><span class="special">&gt;</span>

<span class="identifier">static_assert</span><span class="special">(</span><span class="identifier">FLOATMAX_MAX</span> <span class="special">&gt;</span> <span class="special">(</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">numeric_limits</span><span class="special">&lt;</span><span class="keyword">float</span><span class="special">&gt;::</span><span class="identifier">max</span><span class="special">)(),</span>
              <span class="string">"The iec559 floating-point range is too small."</span><span class="special">);</span>
</pre>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2013 Paul A. Bristow, Christopher Kormanyos, John Maddock<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="literals.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="cmathinterop.html"><img src="../images/next.png" alt="Next"></a>
</div>
</body>
</html>
