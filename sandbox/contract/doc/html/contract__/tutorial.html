<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Tutorial</title>
<link rel="stylesheet" href="../../../doc/src/boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.76.1">
<link rel="home" href="../index.html" title="Chapter&#160;1.&#160;Contract++ 0.4.1">
<link rel="up" href="../index.html" title="Chapter&#160;1.&#160;Contract++ 0.4.1">
<link rel="prev" href="contract_programming_overview.html" title="Contract Programming Overview">
<link rel="next" href="advanced_topics.html" title="Advanced Topics">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><a href="http://sourceforge.net/projects/contractpp/"><img alt="Logo" width="277" height="86" src="../../../logo.png"></a></td>
<td align="center"><a href="http://sourceforge.net/projects/contractpp/files/latest/download">Download</a></td>
<td align="center"><a href="http://sourceforge.net/apps/trac/contractpp/report/3">Bugs</a></td>
<td align="center"><a href="http://sourceforge.net/projects/contractpp/reviews/">Reviews</a></td>
<td align="center"><a href="mailto:lorcaminiti@gmail.com">Contact Us</a></td>
<td align="center"><a href="http://sourceforge.net/projects/contractpp/forums/forum/920163">Help</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="contract_programming_overview.html"><img src="../../..//doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../..//doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../..//doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="advanced_topics.html"><img src="../../..//doc/src/images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="contract__.tutorial"></a><a class="link" href="tutorial.html" title="Tutorial">Tutorial</a>
</h2></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.free_functions">Free Functions</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.preconditions">Preconditions</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.postconditions__result_and_old_values_">Postconditions
      (Result and Old Values)</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.classes_and_class_invariants">Classes
      and Class Invariants</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.constructors">Constructors</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.destructors">Destructors</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.member_functions">Member Functions</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.inheritance_and_subcontracting">Inheritance
      and Subcontracting</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.class_templates">Class Templates</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.function_templates">Function Templates</a></span></dt>
<dt><span class="section"><a href="tutorial.html#contract__.tutorial.forward_declarations_and_body_definitions">Forward
      Declarations and Body Definitions</a></span></dt>
</dl></div>
<p>
      This section explains how to program contracts using this library. See the
      <a class="link" href="grammar.html" title="Grammar">Grammar</a> section for a complete guide
      on this library syntax.
    </p>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.free_functions"></a><a class="link" href="tutorial.html#contract__.tutorial.free_functions" title="Free Functions">Free Functions</a>
</h3></div></div></div>
<p>
        Consider the following free function <code class="computeroutput"><span class="identifier">postinc</span></code>
        which performs a post-increment on its parameter (see also <a href="../../../example/contracts/no_contract_postinc.cpp" target="_top"><code class="literal">no_contract_postinc.cpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="keyword">int</span> <span class="keyword">const</span> <span class="identifier">postinc</span> <span class="special">(</span> <span class="keyword">int</span><span class="special">&amp;</span> <span class="identifier">value</span> <span class="special">)</span>
    <span class="comment">// precondition:    value &lt; std::numeric_limits&lt;int&gt;::max()</span>
    <span class="comment">// postcondition:   value == oldof value + 1</span>
    <span class="comment">//                  result == oldof valule</span>
<span class="special">{</span>
    <span class="keyword">return</span> <span class="identifier">value</span><span class="special">++;</span>
<span class="special">}</span>
</pre>
<p>
      </p>
<p>
        Let's now program the function declaration using the <code class="computeroutput"><a class="link" href="../CONTRACT_FUNCTION.html" title="Macro CONTRACT_FUNCTION">CONTRACT_FUNCTION</a></code>
        macro but without programming the contract yet (see also <a href="../../../example/contracts/no_pre_post_postinc.cpp" target="_top"><code class="literal">no_pre_post_postinc.cpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">contract</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="comment">// Declare free function (for programming contracts).</span>
    <span class="keyword">int</span> <span class="keyword">const</span> <span class="special">(</span><span class="identifier">postinc</span><span class="special">)</span> <span class="special">(</span> <span class="special">(</span><span class="keyword">int</span><span class="special">&amp;)</span> <span class="identifier">value</span> <span class="special">)</span> <span class="comment">// Non-fundamental types in `()`.</span>
        <span class="comment">// precondition:    value &lt; std::numeric_limits&lt;int&gt;::max()</span>
        <span class="comment">// postcondition:   value == oldof value + 1</span>
        <span class="comment">//                  result == oldof value</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="keyword">return</span> <span class="identifier">value</span><span class="special">++;</span>
<span class="special">}</span>
</pre>
<p>
      </p>
<p>
        All necessary header files for this library are included by <code class="computeroutput"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">contract</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span></code>
        (see also the <a class="link" href="getting_started.html" title="Getting Started">Getting Started</a>
        section).
      </p>
<p>
        The function body is programmed outside the library macro. Therefore, while
        this library alters the function declaration syntax, it does not change the
        syntax used to implement the function.
      </p>
<p>
        The function name <code class="computeroutput"><span class="special">(</span><span class="identifier">postinc</span><span class="special">)</span></code> must always be wrapped within parenthesis
        so it can be passed to this library macros.
      </p>
<p>
        The function result and parameter types must be wrapped within parenthesis
        unless they are fundamental types containing no symbol (symbols are tokens
        different from the alphanumeric tokens <code class="computeroutput"><span class="identifier">a</span><span class="special">-</span><span class="identifier">z</span></code>, <code class="computeroutput"><span class="identifier">A</span><span class="special">-</span><span class="identifier">Z</span></code>,
        <code class="computeroutput"><span class="number">0</span><span class="special">-</span><span class="number">9</span></code>). In this example, the result type <code class="computeroutput"><span class="keyword">int</span> <span class="keyword">const</span></code>
        is a fundamental type and it contains no symbol so the parenthesis around
        it <code class="computeroutput"><span class="special">(</span><span class="keyword">int</span>
        <span class="keyword">const</span><span class="special">)</span></code>
        are allowed but not required. <sup>[<a name="contract__.tutorial.free_functions.f0" href="#ftn.contract__.tutorial.free_functions.f0" class="footnote">15</a>]</sup> Instead, the parameter type <code class="computeroutput"><span class="keyword">int</span><span class="special">&amp;</span></code> is a fundamental type but it contains
        the reference symbol <code class="computeroutput"><span class="special">&amp;</span></code> so
        it must be wrapped within parenthesis <code class="computeroutput"><span class="special">(</span><span class="keyword">int</span><span class="special">&amp;)</span></code>.
      </p>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../../../doc/src/images/important.png"></td>
<th align="left">Important</th>
</tr>
<tr><td align="left" valign="top">
<p>
          In general, every token which is not a known keyword (<code class="computeroutput"><span class="keyword">int</span></code>
          is a known keyword but the function name is not) or that contains a non-alphanumeric
          symbol (e.g., <code class="computeroutput"><span class="keyword">int</span><span class="special">&amp;</span></code>)
          must be wrapped within round parenthesis <code class="computeroutput"><span class="special">(...)</span></code>
          unless it is the very last token of a given syntactic element (e.g., the
          function parameter name <code class="computeroutput"><span class="identifier">value</span></code>
          is the last token of the parameter declaration). <sup>[<a name="contract__.tutorial.free_functions.f1" href="#ftn.contract__.tutorial.free_functions.f1" class="footnote">16</a>]</sup>
        </p>
<p>
          See the <a class="link" href="grammar.html" title="Grammar">Grammar</a> section for more
          information.
        </p>
</td></tr>
</table></div>
<p>
        Each function parameter must always specify both its type and its name (parameter
        names can instead by omitted in usual C++ declarations). <sup>[<a name="contract__.tutorial.free_functions.f2" href="#ftn.contract__.tutorial.free_functions.f2" class="footnote">17</a>]</sup> As usual, additional parameters can be specified separated by
        commas <code class="computeroutput"><span class="special">,</span></code> on compilers that support
        variadic macros (these include most modern compilers, MSVC, GCC, and all
        <a href="http://en.wikipedia.org/wiki/C%2B%2B11" target="_top">C++11</a> compilers,
        see the <a class="link" href="no_variadic_macros.html" title="No Variadic Macros">No Variadic Macros</a>
        section for compilers that do not support variadic macros). The configuration
        macro <code class="computeroutput"><a class="link" href="../CONTRACT_CONFIG_FUNCTION_ARITY_MAX.html" title="Macro CONTRACT_CONFIG_FUNCTION_ARITY_MAX">CONTRACT_CONFIG_FUNCTION_ARITY_MAX</a></code>
        indicates the maximum number of function parameters that can be specified.
        An empty parameter list must be specified using <code class="computeroutput"><span class="keyword">void</span></code>
        (this is similar to the usual C++ syntax that allows to declare a function
        with no parameter using <code class="literal"><span class="emphasis"><em>result-type function-name </em></span></code><code class="computeroutput"><span class="special">(</span> <span class="keyword">void</span> <span class="special">)</span></code>).
        <sup>[<a name="contract__.tutorial.free_functions.f3" href="#ftn.contract__.tutorial.free_functions.f3" class="footnote">18</a>]</sup> Default parameter values can be specified using <code class="computeroutput"><span class="special">,</span> <span class="keyword">default</span> </code><code class="literal"><span class="emphasis"><em>default-value</em></span></code>
        immediately following the parameter name. The storage classifiers <code class="computeroutput"><span class="keyword">auto</span></code> and <code class="computeroutput"><span class="keyword">register</span></code>
        can be specified as usual as part of the parameter type. <sup>[<a name="contract__.tutorial.free_functions.f4" href="#ftn.contract__.tutorial.free_functions.f4" class="footnote">19</a>]</sup> Functions can be overloaded by specifying different parameter
        types and they can recursively call themselves as usual.
      </p>
<p>
        For example, the following function <code class="computeroutput"><span class="identifier">postinc</span></code>
        is overloaded to work on <code class="computeroutput"><span class="keyword">long</span></code>
        instead of <code class="computeroutput"><span class="keyword">int</span></code> numbers, it is
        implemented using recursion, it increments the specified number by <code class="computeroutput"><span class="identifier">offset</span></code> which is stored into a register
        variable and it has a default value of <code class="computeroutput"><span class="number">1</span></code>
        (see also <a href="../../../example/contracts/params_postinc.cpp" target="_top"><code class="literal">params_postinc.cpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="comment">// Overload, storage classifiers, and default parameters.</span>
    <span class="keyword">long</span> <span class="keyword">const</span> <span class="special">(</span><span class="identifier">postinc</span><span class="special">)</span> <span class="special">(</span> <span class="special">(</span><span class="keyword">long</span><span class="special">&amp;)</span> <span class="identifier">value</span><span class="special">,</span> <span class="keyword">register</span> <span class="keyword">unsigned</span> <span class="identifier">offset</span><span class="special">,</span> <span class="keyword">default</span> <span class="number">1</span> <span class="special">)</span>
        <span class="comment">// precondition:    value &lt; std::numeric_limits&lt;long&gt;::max()</span>
        <span class="comment">// postcondition:   value == oldof value + offset</span>
        <span class="comment">//                  result == oldof value</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="keyword">long</span> <span class="identifier">result</span> <span class="special">=</span> <span class="identifier">value</span><span class="special">;</span>
    <span class="keyword">if</span><span class="special">(</span><span class="identifier">offset</span> <span class="special">&gt;</span> <span class="number">0</span><span class="special">)</span> <span class="special">{</span>
        <span class="identifier">value</span> <span class="special">+=</span> <span class="number">1</span><span class="special">;</span>
        <span class="identifier">postinc</span><span class="special">(</span><span class="identifier">value</span><span class="special">,</span> <span class="identifier">offset</span> <span class="special">-</span> <span class="number">1</span><span class="special">);</span> <span class="comment">// Recursive calls.</span>
    <span class="special">}</span>
    <span class="keyword">return</span> <span class="identifier">result</span><span class="special">;</span>
<span class="special">}</span>
</pre>
<p>
      </p>
<p>
</p>
<pre class="programlisting"><span class="keyword">long</span> <span class="identifier">value</span> <span class="special">=</span> <span class="number">1</span><span class="special">;</span>
<span class="identifier">BOOST_TEST</span><span class="special">(</span><span class="identifier">postinc</span><span class="special">(</span><span class="identifier">value</span><span class="special">)</span> <span class="special">==</span> <span class="number">1</span><span class="special">);</span>    <span class="comment">// Increment of 1 (it is 1).</span>
<span class="identifier">BOOST_TEST</span><span class="special">(</span><span class="identifier">postinc</span><span class="special">(</span><span class="identifier">value</span><span class="special">,</span> <span class="number">4</span><span class="special">)</span> <span class="special">==</span> <span class="number">2</span><span class="special">);</span> <span class="comment">// Increment of 4 (it is 2).</span>
<span class="identifier">BOOST_TEST</span><span class="special">(</span><span class="identifier">value</span> <span class="special">==</span> <span class="number">6</span><span class="special">);</span>             <span class="comment">// Incremented of 4 (it was 2).</span>
</pre>
<p>
      </p>
<p>
        Function and array types cannot be directly used as function parameter types
        within the contract macros but extra <code class="computeroutput"><span class="keyword">typedef</span></code>
        declarations can be used to workaround this limitation (for multi-dimensional
        arrays, the maximum number of supported array dimensions is specified by
        the <code class="computeroutput"><a class="link" href="../CONTRACT_CONFIG_ARRAY_DIMENSION_MAX.html" title="Macro CONTRACT_CONFIG_ARRAY_DIMENSION_MAX">CONTRACT_CONFIG_ARRAY_DIMENSION_MAX</a></code>
        macro). For example (see also <a href="../../../example/contracts/params_funcptr_array_apply.cpp" target="_top"><code class="literal">params_funcptr_array_apply.cpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="comment">// Contracts cannot directly use array type syntax, use via `typedef` instead.</span>
<span class="keyword">typedef</span> <span class="keyword">int</span> <span class="identifier">array_2x3</span><span class="special">[</span><span class="number">2</span><span class="special">][</span><span class="number">3</span><span class="special">];</span>
<span class="keyword">typedef</span> <span class="keyword">int</span> <span class="special">(*</span><span class="identifier">func_ptr</span><span class="special">)</span> <span class="special">(</span> <span class="keyword">int</span> <span class="special">);</span>

<span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
    <span class="keyword">void</span> <span class="special">(</span><span class="identifier">apply</span><span class="special">)</span> <span class="special">(</span> <span class="special">(</span><span class="identifier">func_ptr</span><span class="special">)</span> <span class="identifier">f</span><span class="special">,</span> <span class="special">(</span><span class="identifier">array_2x3</span><span class="special">)</span> <span class="identifier">m</span> <span class="special">)</span>
        <span class="comment">// precondition:    f != NULL</span>
        <span class="comment">//                  m != NULL</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="keyword">for</span> <span class="special">(</span> <span class="keyword">size_t</span> <span class="identifier">i</span> <span class="special">=</span> <span class="number">0</span><span class="special">;</span> <span class="identifier">i</span> <span class="special">&lt;</span> <span class="number">2</span><span class="special">;</span> <span class="special">++</span><span class="identifier">i</span><span class="special">)</span>
        <span class="keyword">for</span> <span class="special">(</span> <span class="keyword">size_t</span> <span class="identifier">j</span> <span class="special">=</span> <span class="number">0</span><span class="special">;</span> <span class="identifier">j</span> <span class="special">&lt;</span> <span class="number">3</span><span class="special">;</span> <span class="special">++</span><span class="identifier">j</span><span class="special">)</span>
            <span class="identifier">m</span><span class="special">[</span><span class="identifier">i</span><span class="special">][</span><span class="identifier">j</span><span class="special">]</span> <span class="special">=</span> <span class="identifier">f</span><span class="special">(</span><span class="identifier">m</span><span class="special">[</span><span class="identifier">i</span><span class="special">][</span><span class="identifier">j</span><span class="special">]);</span>
<span class="special">}</span>

<span class="keyword">int</span> <span class="identifier">offset</span> <span class="special">(</span> <span class="keyword">int</span> <span class="identifier">i</span> <span class="special">)</span> <span class="special">{</span> <span class="keyword">return</span> <span class="identifier">i</span> <span class="special">+</span> <span class="number">10</span><span class="special">;</span> <span class="special">}</span>
</pre>
<p>
      </p>
<p>
</p>
<pre class="programlisting"><span class="keyword">int</span> <span class="identifier">x</span><span class="special">[</span><span class="number">2</span><span class="special">][</span><span class="number">3</span><span class="special">]</span> <span class="special">=</span> <span class="special">{</span>
    <span class="special">{</span><span class="number">1</span><span class="special">,</span> <span class="number">2</span><span class="special">,</span> <span class="number">3</span><span class="special">},</span>
    <span class="special">{</span><span class="number">4</span><span class="special">,</span> <span class="number">5</span><span class="special">,</span> <span class="number">6</span><span class="special">}</span>
<span class="special">};</span>
<span class="identifier">apply</span><span class="special">(</span><span class="identifier">offset</span><span class="special">,</span> <span class="identifier">x</span><span class="special">);</span>
</pre>
<p>
      </p>
<p>
        Spaces and new-lines make no syntactical difference and they can be used
        freely within this library macros. <sup>[<a name="contract__.tutorial.free_functions.f5" href="#ftn.contract__.tutorial.free_functions.f5" class="footnote">20</a>]</sup> The following aesthetic conventions are followed in this documentation
        (because the authors think they improve readability):
      </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
            Round parenthesis are spaced when a list of tokens is expected (e.g.,
            the function parameter list): <code class="computeroutput"><span class="special">(</span>
            </code><code class="literal"><span class="emphasis"><em>token1</em></span></code><code class="computeroutput"> <span class="special">)</span></code>,
            <code class="computeroutput"><span class="special">(</span> </code><code class="literal"><span class="emphasis"><em>token1</em></span></code><code class="computeroutput"><span class="special">,</span> </code><code class="literal"><span class="emphasis"><em>token2</em></span></code><code class="computeroutput">
            <span class="special">)</span></code>, <code class="computeroutput"><span class="special">(</span>
            </code><code class="literal"><span class="emphasis"><em>token1</em></span></code><code class="computeroutput"><span class="special">,</span>
            </code><code class="literal"><span class="emphasis"><em>token2</em></span></code><code class="computeroutput"><span class="special">,</span>
            </code><code class="literal"><span class="emphasis"><em>token3</em></span></code><code class="computeroutput"> <span class="special">)</span></code>,
            etc.
          </li>
<li class="listitem">
            Round parenthesis are not spaced when only a single token is expected
            (e.g., the function name): <code class="computeroutput"><span class="special">(</span></code><code class="literal"><span class="emphasis"><em>token</em></span></code><code class="computeroutput"><span class="special">)</span></code>.
          </li>
</ol></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.preconditions"></a><a class="link" href="tutorial.html#contract__.tutorial.preconditions" title="Preconditions">Preconditions</a>
</h3></div></div></div>
<p>
        Let's program the preconditions of <code class="computeroutput"><span class="identifier">postinc</span></code>
        (see also <a href="../../../example/contracts/pre_only_postinc.cpp" target="_top"><code class="literal">pre_only_postinc.cpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
    <span class="keyword">int</span> <span class="keyword">const</span> <span class="special">(</span><span class="identifier">postinc</span><span class="special">)</span> <span class="special">(</span> <span class="special">(</span><span class="keyword">int</span><span class="special">&amp;)</span> <span class="identifier">value</span> <span class="special">)</span>
        <span class="keyword">precondition</span><span class="special">(</span> <span class="identifier">value</span> <span class="special">&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">numeric_limits</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;::</span><span class="identifier">max</span><span class="special">()</span> <span class="special">)</span> <span class="comment">// Precondition.</span>
        <span class="comment">// postcondition:   value == oldof value + 1</span>
        <span class="comment">//                  result == oldof value</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="keyword">return</span> <span class="identifier">value</span><span class="special">++;</span>
<span class="special">}</span>
</pre>
<p>
      </p>
<p>
        In this example, the preconditions assert only one boolean condition but
        additional boolean conditions can be listed separated by commas <code class="computeroutput"><span class="special">,</span></code>. Preconditions are automatically checked
        by the library when the <code class="computeroutput"><span class="identifier">postinc</span></code>
        function is called, immediately before the body is executed (i.e., at function
        <span class="emphasis"><em>entry</em></span>). See also the <a class="link" href="contract_programming_overview.html#contract__.contract_programming_overview.free_function_calls" title="Free Function Calls">Free
        Function Calls</a> section.
      </p>
<p>
        Contracts are supposed to check but not to modify the state of the program
        (see the <a class="link" href="contract_programming_overview.html#contract__.contract_programming_overview.constant_correctness" title="Constant-Correctness">Constant-Correctness</a>
        section). Therefore, this library evaluates all contract conditions in constant-correct
        context. Specifically, in this example the type of <code class="computeroutput"><span class="identifier">value</span></code>
        is automatically promoted from <code class="computeroutput"><span class="keyword">int</span><span class="special">&amp;</span></code> to <code class="computeroutput"><span class="keyword">int</span>
        <span class="keyword">const</span><span class="special">&amp;</span></code>
        within the preconditions and an attempt to modify <code class="computeroutput"><span class="identifier">value</span></code>
        within the preconditions will correctly generate a compile-time error.
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.postconditions__result_and_old_values_"></a><a class="link" href="tutorial.html#contract__.tutorial.postconditions__result_and_old_values_" title="Postconditions (Result and Old Values)">Postconditions
      (Result and Old Values)</a>
</h3></div></div></div>
<p>
        Let's program the postconditions of <code class="computeroutput"><span class="identifier">postinc</span></code>
        completing the contract (see also <a href="../../../example/contracts/post_also_postinc.cpp" target="_top"><code class="literal">post_also_postinc.cpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
    <span class="keyword">int</span> <span class="keyword">const</span> <span class="special">(</span><span class="identifier">postinc</span><span class="special">)</span> <span class="special">(</span> <span class="special">(</span><span class="keyword">int</span><span class="special">&amp;)</span> <span class="identifier">value</span> <span class="special">)</span>
        <span class="keyword">precondition</span><span class="special">(</span> <span class="identifier">value</span> <span class="special">&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">numeric_limits</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;::</span><span class="identifier">max</span><span class="special">()</span> <span class="special">)</span>
        <span class="keyword">postcondition</span><span class="special">(</span>                              <span class="comment">// Postconditions.</span>
            <span class="keyword">auto</span> <span class="identifier">result</span> <span class="special">=</span> <span class="keyword">return</span><span class="special">,</span>                   <span class="comment">// Result value.</span>
            <span class="keyword">auto</span> <span class="identifier">old_value</span> <span class="special">=</span> <span class="identifier">CONTRACT_OLDOF</span> <span class="identifier">value</span><span class="special">,</span>  <span class="comment">// Old value(s).</span>
            <span class="identifier">value</span> <span class="special">==</span> <span class="identifier">old_value</span> <span class="special">+</span> <span class="number">1</span><span class="special">,</span>                 <span class="comment">// Assertion(s)...</span>
            <span class="identifier">result</span> <span class="special">==</span> <span class="identifier">old_value</span>
        <span class="special">)</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="keyword">return</span> <span class="identifier">value</span><span class="special">++;</span>
<span class="special">}</span>
</pre>
<p>
      </p>
<p>
        Postconditions are automatically checked by the library when the <code class="computeroutput"><span class="identifier">postinc</span></code> function is called, immediately
        after the body is executed but only if the body does not throw an exception
        (i.e., at function <span class="emphasis"><em>normal exit</em></span>). See also the <a class="link" href="contract_programming_overview.html#contract__.contract_programming_overview.free_function_calls" title="Free Function Calls">Free
        Function Calls</a> section.
      </p>
<p>
        Postconditions can access the function return value by declaring a variable
        of type <code class="computeroutput"><span class="keyword">auto</span></code> <sup>[<a name="contract__.tutorial.postconditions__result_and_old_values_.f0" href="#ftn.contract__.tutorial.postconditions__result_and_old_values_.f0" class="footnote">21</a>]</sup> and assigning it to the <code class="computeroutput"><span class="keyword">return</span></code>
        keyword (the variable name is arbitrary but <code class="computeroutput"><span class="identifier">result</span></code>
        is often used).
      </p>
<p>
        Postconditions can also access the <span class="emphasis"><em>old value</em></span> that an
        expression had just before the body was executed. This is done by declaring
        a variable of type <code class="computeroutput"><span class="keyword">auto</span></code> and
        assigning it to <code class="computeroutput"><a class="link" href="../CONTRACT_OLDOF.html" title="Macro CONTRACT_OLDOF">CONTRACT_OLDOF</a></code>
        <code class="literal"><span class="emphasis"><em>expression</em></span></code> (the variable name is
        arbitrary but the <code class="computeroutput"><span class="identifier">old_</span></code> prefix
        is often used). Before executing the function body, the library automatically
        copies (once) the value of the specified expression into a variable with
        the specified name which is then made available to the postconditions. Therefore,
        the type of an old value expression must have a copy constructor (or, more
        precisely, it must be be <a class="link" href="advanced_topics.html#contract__.advanced_topics.old_and_result_value_copies" title="Old and Result Value Copies"><code class="literal">ConstantCopyConstructible</code></a>),
        otherwise the library will generate a compile-time error. The parenthesis
        around the expression passed to the <code class="computeroutput"><a class="link" href="../CONTRACT_OLDOF.html" title="Macro CONTRACT_OLDOF">CONTRACT_OLDOF</a></code>
        macro are allowed but not required (in this example, <code class="computeroutput"><span class="identifier">CONTRACT_OLDOF</span><span class="special">(</span><span class="identifier">value</span><span class="special">)</span></code> could have been equivalently used instead
        of <code class="computeroutput"><span class="identifier">CONTRACT_OLDOF</span> <span class="identifier">value</span></code>
        but the latter was preferred because of lesser parenthesis). In this sense,
        the syntax of the <code class="computeroutput"><span class="identifier">CONTRACT_OLDOF</span></code>
        macro resembles the syntax of the <code class="computeroutput"><span class="keyword">sizeof</span></code>
        operator which also allows but does not require parenthesis when applied
        to value expressions (i.e., <code class="computeroutput"><span class="keyword">sizeof</span>
        <span class="identifier">value</span></code> and <code class="computeroutput"><span class="keyword">sizeof</span><span class="special">(</span><span class="identifier">value</span><span class="special">)</span></code> are both valid). <sup>[<a name="contract__.tutorial.postconditions__result_and_old_values_.f1" href="#ftn.contract__.tutorial.postconditions__result_and_old_values_.f1" class="footnote">22</a>]</sup> (The maximum number of supported and possible old value declarations
        is specified by the <code class="computeroutput"><a class="link" href="../CONTRACT_CONFIG_OLDOF_MAX.html" title="Macro CONTRACT_CONFIG_OLDOF_MAX">CONTRACT_CONFIG_OLDOF_MAX</a></code>
        and <code class="computeroutput"><a class="link" href="../CONTRACT_LIMIT_OLDOFS.html" title="Macro CONTRACT_LIMIT_OLDOFS">CONTRACT_LIMIT_OLDOFS</a></code>
        macros respectively.)
      </p>
<p>
        Postconditions always access result and old values in constant-correct context
        so that contracts cannot modify the state of the program (see the <a class="link" href="contract_programming_overview.html#contract__.contract_programming_overview.constant_correctness" title="Constant-Correctness">Constant-Correctness</a>
        section).
      </p>
<p>
        In general, it is recommended to specify multiple assertions separated by
        commas and not to group them together into a single condition using the operator
        <code class="computeroutput"><span class="keyword">and</span></code> (or <code class="computeroutput"><span class="special">&amp;&amp;</span></code>).
        This is because if assertion conditions are programmed together using <code class="computeroutput"><span class="keyword">and</span></code> then it will not be clear which assertion
        condition actually failed in case the contract is broken. For example, if
        in the code above we programmed one single postcondition <code class="computeroutput"><span class="special">(</span><span class="identifier">value</span> <span class="special">==</span> <span class="identifier">old_value</span> <span class="special">+</span> <span class="number">1</span><span class="special">)</span> <span class="keyword">and</span>
        <span class="special">(</span><span class="identifier">result</span>
        <span class="special">==</span> <span class="identifier">old_value</span><span class="special">)</span></code> then in case the postcondition failed we
        would not know which condition failed <code class="computeroutput"><span class="identifier">value</span>
        <span class="special">==</span> <span class="identifier">old_value</span>
        <span class="special">+</span> <span class="number">1</span></code>
        or <code class="computeroutput"><span class="identifier">result</span> <span class="special">==</span>
        <span class="identifier">old_value</span></code>.
      </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../doc/src/images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
          All tokens must be specified in the fixed order listed in the <a class="link" href="grammar.html" title="Grammar">Grammar</a>
          section (it is not possible to specify postconditions before preconditions,
          <code class="computeroutput"><span class="keyword">volatile</span></code> before <code class="computeroutput"><span class="keyword">const</span></code> for member functions, etc). <sup>[<a name="contract__.tutorial.postconditions__result_and_old_values_.f2" href="#ftn.contract__.tutorial.postconditions__result_and_old_values_.f2" class="footnote">23</a>]</sup>
        </p></td></tr>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.classes_and_class_invariants"></a><a class="link" href="tutorial.html#contract__.tutorial.classes_and_class_invariants" title="Classes and Class Invariants">Classes
      and Class Invariants</a>
</h3></div></div></div>
<p>
        Consider the following class <code class="computeroutput"><span class="identifier">ivector</span></code>
        which is a vector of integers with a constructor, destructor, and the <code class="computeroutput"><span class="identifier">push_back</span></code> member function (see also <a href="../../../example/contracts/no_contract_ivector.cpp" target="_top"><code class="literal">no_contract_ivector.cpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="keyword">class</span> <span class="identifier">ivector</span>
<span class="special">{</span>
    <span class="comment">// invariant:   empty() == (size() == 0)</span>
    <span class="comment">//              size() &lt;= capacity()</span>
    <span class="comment">//              capacity() &lt;= max_size()</span>
    <span class="comment">//              std::distance(begin(), end()) == int(size())</span>

    <span class="keyword">public</span><span class="special">:</span> <span class="keyword">typedef</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;::</span><span class="identifier">size_type</span> <span class="identifier">size_type</span><span class="special">;</span>

    <span class="keyword">public</span><span class="special">:</span> <span class="keyword">explicit</span> <span class="identifier">ivector</span> <span class="special">(</span> <span class="identifier">size_type</span> <span class="identifier">count</span> <span class="special">)</span>
        <span class="comment">// precondition:    count &gt;= 0</span>
        <span class="comment">// postcondition:   size() == count</span>
        <span class="comment">//                  boost::algorithm::all_of_equal(begin(), end(), 0)</span>
        <span class="special">:</span> <span class="identifier">vector_</span><span class="special">(</span><span class="identifier">count</span><span class="special">)</span>
    <span class="special">{}</span>

    <span class="keyword">public</span><span class="special">:</span> <span class="keyword">virtual</span> <span class="special">~</span><span class="identifier">ivector</span> <span class="special">(</span> <span class="keyword">void</span> <span class="special">)</span> <span class="special">{}</span>

    <span class="keyword">public</span><span class="special">:</span> <span class="keyword">void</span> <span class="identifier">push_back</span> <span class="special">(</span> <span class="keyword">int</span> <span class="keyword">const</span> <span class="identifier">value</span> <span class="special">)</span>
        <span class="comment">// precondition:    size() &lt; max_size()</span>
        <span class="comment">// postcondition:   size() == oldof size() + 1</span>
        <span class="comment">//                  capacity() &gt;= oldof capacity()</span>
        <span class="comment">//                  back() == value</span>
    <span class="special">{</span>
        <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">push_back</span><span class="special">(</span><span class="identifier">value</span><span class="special">);</span>
    <span class="special">}</span>

    <span class="keyword">private</span><span class="special">:</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;</span> <span class="identifier">vector_</span><span class="special">;</span>
<span class="special">};</span>
</pre>
<p>
      </p>
<p>
        Let's program the class declaration and the class invariants using the <code class="computeroutput"><a class="link" href="../CONTRACT_CLASS.html" title="Macro CONTRACT_CLASS">CONTRACT_CLASS</a></code> and <code class="computeroutput"><a class="link" href="../CONTRACT_CLASS_INVARIANT.html" title="Macro CONTRACT_CLASS_INVARIANT">CONTRACT_CLASS_INVARIANT</a></code>
        macros respectively (see also <a href="../../../example/contracts/class_ivector.cpp" target="_top"><code class="literal">class_ivector.cpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">CONTRACT_CLASS</span><span class="special">(</span> <span class="comment">// Declare the class.</span>
    <span class="keyword">class</span> <span class="special">(</span><span class="identifier">ivector</span><span class="special">)</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="identifier">CONTRACT_CLASS_INVARIANT</span><span class="special">(</span> <span class="comment">// Specify the class invariants.</span>
        <span class="identifier">empty</span><span class="special">()</span> <span class="special">==</span> <span class="special">(</span><span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="number">0</span><span class="special">),</span>
        <span class="identifier">size</span><span class="special">()</span> <span class="special">&lt;=</span> <span class="identifier">capacity</span><span class="special">(),</span>
        <span class="identifier">capacity</span><span class="special">()</span> <span class="special">&lt;=</span> <span class="identifier">max_size</span><span class="special">(),</span>
        <span class="identifier">std</span><span class="special">::</span><span class="identifier">distance</span><span class="special">(</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">end</span><span class="special">())</span> <span class="special">==</span> <span class="keyword">int</span><span class="special">(</span><span class="identifier">size</span><span class="special">())</span>
    <span class="special">)</span>

    <span class="keyword">public</span><span class="special">:</span> <span class="keyword">typedef</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;::</span><span class="identifier">size_type</span> <span class="identifier">size_type</span><span class="special">;</span>
    <span class="comment">// ...</span>
</pre>
<p>
      </p>
<p>
        A class must always be declared using the <code class="computeroutput"><a class="link" href="../CONTRACT_CLASS.html" title="Macro CONTRACT_CLASS">CONTRACT_CLASS</a></code>
        macro in oder to later be able to program contracts for its constructors,
        destructor, and member functions. Similarly to function names, the class
        name must always be wrapped within parenthesis <code class="computeroutput"><span class="special">(</span><span class="identifier">ivector</span><span class="special">)</span></code>
        (because the class name is not a known keyword and it is not the last element
        of the class declaration syntax for example when base classes and are specified
        after the class name). Only constructors, destructors, and member functions
        that are public check the class invariants while the ones that are either
        protected or private do not (see the <a class="link" href="contract_programming_overview.html" title="Contract Programming Overview">Contract
        Programming Overview</a> section). The class invariant must always be
        specified for a class declared using the <code class="computeroutput"><a class="link" href="../CONTRACT_CLASS.html" title="Macro CONTRACT_CLASS">CONTRACT_CLASS</a></code>
        macro and it must appear at the very beginning of the class definition (no
        statement can precede the <code class="computeroutput"><a class="link" href="../CONTRACT_CLASS_INVARIANT.html" title="Macro CONTRACT_CLASS_INVARIANT">CONTRACT_CLASS_INVARIANT</a></code>
        macro, not even a <code class="computeroutput"><span class="keyword">typedef</span></code> or
        a <code class="computeroutput"><span class="keyword">friend</span></code> declaration). If a
        class has no class invariant, the class invariants must be specified <code class="computeroutput"><span class="keyword">void</span></code>:
      </p>
<pre class="programlisting"><span class="identifier">CONTRACT_CLASS</span><span class="special">(</span>
    <span class="keyword">class</span> <span class="special">(</span><span class="identifier">ivector</span><span class="special">)</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="identifier">CONTRACT_CLASS_INVARIANT</span><span class="special">(</span> <span class="keyword">void</span> <span class="special">)</span> <span class="comment">// No class invariant.</span>

    <span class="comment">// ...</span>
</pre>
<p>
        Using the same macro, this library also allows to specify contracts for
        <code class="computeroutput"><span class="keyword">struct</span></code>: <sup>[<a name="contract__.tutorial.classes_and_class_invariants.f0" href="#ftn.contract__.tutorial.classes_and_class_invariants.f0" class="footnote">24</a>]</sup>
      </p>
<pre class="programlisting"><span class="identifier">CONTRACT_CLASS</span><span class="special">(</span>
    <span class="keyword">struct</span> <span class="special">(</span><span class="identifier">ivector</span><span class="special">)</span> <span class="comment">// Structs with contracts.</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="comment">// ...</span>
</pre>
<p>
        The usual differences between <code class="computeroutput"><span class="keyword">struct</span></code>
        and <code class="computeroutput"><span class="keyword">class</span></code> also apply when this
        library is used (i.e., default member and inheritance access levels are
        <code class="computeroutput"><span class="keyword">public</span></code> for <code class="computeroutput"><span class="keyword">struct</span></code>
        and <code class="computeroutput"><span class="keyword">private</span></code> for <code class="computeroutput"><span class="keyword">class</span></code>).
      </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../doc/src/images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
          Unfortunately, this library does not allow to specify contracts for <code class="computeroutput"><span class="keyword">union</span></code>. <sup>[<a name="contract__.tutorial.classes_and_class_invariants.f1" href="#ftn.contract__.tutorial.classes_and_class_invariants.f1" class="footnote">25</a>]</sup>
        </p></td></tr>
</table></div>
<p>
        No contracts are checked (not event the class invariants) when a data member
        is accessed directly so it might be best for both classes and structs to
        have no non-constant public data member (but access all data members via
        appropriate member functions that can check the class and sturct contracts).
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.constructors"></a><a class="link" href="tutorial.html#contract__.tutorial.constructors" title="Constructors">Constructors</a>
</h3></div></div></div>
<p>
        Let's program the <code class="computeroutput"><span class="identifier">ivector</span></code>
        class constructor and its contract using the <code class="computeroutput"><a class="link" href="../CONTRACT_CONSTRUCTOR.html" title="Macro CONTRACT_CONSTRUCTOR">CONTRACT_CONSTRUCTOR</a></code>
        macro (see also <a href="../../../example/contracts/class_ivector.cpp" target="_top"><code class="literal">class_ivector.cpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">CONTRACT_CONSTRUCTOR</span><span class="special">(</span> <span class="comment">// Declare the constructor and its contract.</span>
    <span class="keyword">public</span> <span class="keyword">explicit</span> <span class="special">(</span><span class="identifier">ivector</span><span class="special">)</span> <span class="special">(</span> <span class="special">(</span><span class="identifier">size_type</span><span class="special">)</span> <span class="identifier">count</span> <span class="special">)</span>
        <span class="keyword">precondition</span><span class="special">(</span> <span class="identifier">count</span> <span class="special">&gt;=</span> <span class="number">0</span> <span class="special">)</span>
        <span class="keyword">postcondition</span><span class="special">(</span>
            <span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="identifier">count</span><span class="special">,</span>
            <span class="identifier">boost</span><span class="special">::</span><span class="identifier">algorithm</span><span class="special">::</span><span class="identifier">all_of_equal</span><span class="special">(</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">end</span><span class="special">(),</span> <span class="number">0</span><span class="special">)</span>
        <span class="special">)</span>
        <span class="keyword">initialize</span><span class="special">(</span> <span class="identifier">vector_</span><span class="special">(</span><span class="identifier">count</span><span class="special">)</span> <span class="special">)</span>
<span class="special">)</span> <span class="special">{}</span>
</pre>
<p>
      </p>
<p>
        Constructor, destructor, and member function declarations must always repeat
        their access level <code class="computeroutput"><span class="keyword">public</span></code>,
        <code class="computeroutput"><span class="keyword">protected</span></code>, or <code class="computeroutput"><span class="keyword">private</span></code> <sup>[<a name="contract__.tutorial.constructors.f0" href="#ftn.contract__.tutorial.constructors.f0" class="footnote">26</a>]</sup> which is specified without the usual trailing column symbol
        <code class="computeroutput"><span class="special">:</span></code>. (This use of <code class="computeroutput"><span class="keyword">public</span></code>, <code class="computeroutput"><span class="keyword">protected</span></code>,
        and <code class="computeroutput"><span class="keyword">private</span></code> resembles <a href="http://en.wikipedia.org/wiki/Java_(programming_language)" target="_top">Java</a>'s
        syntax.)
      </p>
<p>
        The constructor name <code class="computeroutput"><span class="special">(</span><span class="identifier">ivector</span><span class="special">)</span></code> and the non-fundamental parameter type
        <code class="computeroutput"><span class="special">(</span><span class="identifier">size_type</span><span class="special">)</span></code> must be wrapped within parenthesis (because
        they are not known keywords and they are not at the end of a syntactic element).
      </p>
<p>
        Member initializers are programed as a comma-separated list but using the
        specifier <code class="literal">initialize( <span class="emphasis"><em>expression1</em></span>, <span class="emphasis"><em>expression2</em></span>,
        ... )</code> instead of the usual column symbol <code class="literal">: <span class="emphasis"><em>expression1</em></span>,
        <span class="emphasis"><em>expression2</em></span>, ...</code>. When specified, they must
        appear at the very end of constructor declarations (after both preconditions
        and postcondition if present). <sup>[<a name="contract__.tutorial.constructors.f1" href="#ftn.contract__.tutorial.constructors.f1" class="footnote">27</a>]</sup> Unfortunately, when member initializers are specified, the constructor
        body must be defined together with its declaration and contract (see the
        <a class="link" href="tutorial.html#contract__.tutorial.forward_declarations_and_body_definitions" title="Forward Declarations and Body Definitions">Forward
        Declarations and Body Definitions</a> section).
      </p>
<p>
        There is no object before the constructor body is executed, therefore this
        library will generate a compile-time error if either preconditions or postcondition
        old value expressions try to access the object <code class="computeroutput"><span class="keyword">this</span></code>.
        For the same reason, only static class invariants are checked at entry of
        public constructors (non-static class invariants are checked at public constructor
        normal exit but not at entry). Finally, preconditions are checked before
        member initializers are executed (so the initializers can rely on preconditions
        for validating constructor arguments). See also the <a class="link" href="contract_programming_overview.html#contract__.contract_programming_overview.constructor_calls" title="Constructor Calls">Constructor
        Calls</a> section.
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.destructors"></a><a class="link" href="tutorial.html#contract__.tutorial.destructors" title="Destructors">Destructors</a>
</h3></div></div></div>
<p>
        Let's program the <code class="computeroutput"><span class="identifier">ivector</span></code>
        class destructor using the <code class="computeroutput"><a class="link" href="../CONTRACT_DESTRUCTOR.html" title="Macro CONTRACT_DESTRUCTOR">CONTRACT_DESTRUCTOR</a></code>
        macro (see also <a href="../../../example/contracts/class_ivector.cpp" target="_top"><code class="literal">class_ivector.cpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">CONTRACT_DESTRUCTOR</span><span class="special">(</span> <span class="comment">// Declare the destructor (so it checks invariants).</span>
    <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="special">(~</span><span class="identifier">ivector</span><span class="special">)</span> <span class="special">(</span> <span class="keyword">void</span> <span class="special">)</span>
<span class="special">)</span> <span class="special">{}</span>
</pre>
<p>
      </p>
<p>
        The destructor access level <code class="computeroutput"><span class="keyword">public</span></code>,
        <code class="computeroutput"><span class="keyword">protected</span></code>, or <code class="computeroutput"><span class="keyword">private</span></code> must always be specified. The destructor
        name <code class="computeroutput"><span class="special">(~</span><span class="identifier">ivector</span><span class="special">)</span></code> must be wrapped within parenthesis. The
        destructor empty parameter list must be specified using <code class="computeroutput"><span class="keyword">void</span></code>
        (same as for constructors, member functions, and free functions with no parameters).
      </p>
<p>
        Destructors have no parameter and there is no object after the destructor
        body is executed. Therefore, destructors cannot specify neither preconditions
        nor postconditions. <sup>[<a name="contract__.tutorial.destructors.f0" href="#ftn.contract__.tutorial.destructors.f0" class="footnote">28</a>]</sup> However, it is still necessary to contract (at least public)
        destructors so they check static and non-static class invariants at entry,
        and non-static class invariants at exit. See also the <a class="link" href="contract_programming_overview.html#contract__.contract_programming_overview.destructor_calls" title="Destructor Calls">Destructor
        Calls</a> section.
      </p>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../../../doc/src/images/important.png"></td>
<th align="left">Important</th>
</tr>
<tr><td align="left" valign="top"><p>
          Only members declared using this library macros check the class invariants.
          Therefore, at least all public members of a class with non-empty class
          invariants should be declared using this library macros even when they
          have no preconditions and no postconditions so that they check the class
          invariants (that is the case for public destructors).
        </p></td></tr>
</table></div>
<p>
        In general, there is no need to use this library macros to declare free functions,
        constructors, destructors, and member function only when:
      </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
            A free function has no preconditions and no postconditions.
          </li>
<li class="listitem">
            A private or protected constructor, destructor, or member function has
            no preconditions and no postconditions (regardless of class invariants
            because private and protected members never check class invariants).
          </li>
<li class="listitem">
            A public constructor, destructor, or member function has no preconditions,
            no postconditions, and its class has no class invariants.
          </li>
</ol></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.member_functions"></a><a class="link" href="tutorial.html#contract__.tutorial.member_functions" title="Member Functions">Member Functions</a>
</h3></div></div></div>
<p>
        Let's program the member function <code class="computeroutput"><span class="identifier">ivector</span><span class="special">::</span><span class="identifier">push_back</span></code>
        and its contract using the <code class="computeroutput"><a class="link" href="../CONTRACT_FUNCTION.html" title="Macro CONTRACT_FUNCTION">CONTRACT_FUNCTION</a></code>
        macro (see also <a href="../../../example/contracts/class_ivector.cpp" target="_top"><code class="literal">class_ivector.cpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="comment">// Declare the member function with its contract.</span>
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="special">(</span><span class="identifier">push_back</span><span class="special">)</span> <span class="special">(</span> <span class="keyword">int</span> <span class="keyword">const</span> <span class="identifier">value</span> <span class="special">)</span>
        <span class="keyword">precondition</span><span class="special">(</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">&lt;</span> <span class="identifier">max_size</span><span class="special">()</span> <span class="special">)</span>
        <span class="keyword">postcondition</span><span class="special">(</span>
            <span class="keyword">auto</span> <span class="identifier">old_size</span> <span class="special">=</span> <span class="identifier">CONTRACT_OLDOF</span> <span class="identifier">size</span><span class="special">(),</span>
            <span class="keyword">auto</span> <span class="identifier">old_capacity</span> <span class="special">=</span> <span class="identifier">CONTRACT_OLDOF</span> <span class="identifier">capacity</span><span class="special">(),</span>
            <span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="identifier">old_size</span> <span class="special">+</span> <span class="number">1</span><span class="special">,</span>
            <span class="identifier">capacity</span><span class="special">()</span> <span class="special">&gt;=</span> <span class="identifier">old_capacity</span><span class="special">,</span>
            <span class="identifier">back</span><span class="special">()</span> <span class="special">==</span> <span class="identifier">value</span>
        <span class="special">)</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">push_back</span><span class="special">(</span><span class="identifier">value</span><span class="special">);</span>
<span class="special">}</span>
</pre>
<p>
      </p>
<p>
        The member function access level <code class="computeroutput"><span class="keyword">public</span></code>,
        <code class="computeroutput"><span class="keyword">protected</span></code>, or <code class="computeroutput"><span class="keyword">private</span></code> must always be specified. The member
        function name <code class="computeroutput"><span class="special">(</span><span class="identifier">push_back</span><span class="special">)</span></code> must be wrapped within parenthesis. The
        member function result type <code class="computeroutput"><span class="keyword">void</span></code>
        and parameter type <code class="computeroutput"><span class="keyword">int</span> <span class="keyword">const</span></code>
        can but do not have to be wrapped within parenthesis (because they are both
        fundamental types containing no symbol).
      </p>
<p>
        Public non-static member functions check static and non-static class invariants
        at both entry and exit. Preconditions are checked at entry and postconditions
        are checked at normal exit. Both preconditions and postconditions can access
        the object and the member function parameters in constant-correct context.
        Postconditions can declare return and old value variables (again, in constant-correct
        context). See also the <a class="link" href="contract_programming_overview.html#contract__.contract_programming_overview.member_function_calls" title="Member Function Calls">Member
        Function Calls</a> section.
      </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../doc/src/images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top">
<p>
          Contracts are most useful when the assertions only use public members that
          are accessible from the caller so the caller can properly verify and use
          the contract. In particular, preconditions of a member function or constructor
          that use non-public members are essentially incorrect because they cannot
          be verified by the caller before calling the function (in fact, <a href="http://en.wikipedia.org/wiki/Eiffel_(programming_language)" target="_top">Eiffel</a>
          generates a compile-time error in this case).
        </p>
<p>
          This library leave it up to programmers to only use public members when
          programming contracts and especially when programming preconditions (see
          the <a class="link" href="contract_programming_overview.html#contract__.contract_programming_overview.specification_vs__implementation" title="Specification vs. Implementation">Specification
          vs. Implementation</a> section).
        </p>
</td></tr>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.inheritance_and_subcontracting"></a><a class="link" href="tutorial.html#contract__.tutorial.inheritance_and_subcontracting" title="Inheritance and Subcontracting">Inheritance
      and Subcontracting</a>
</h3></div></div></div>
<p>
        Consider the following class <code class="computeroutput"><span class="identifier">unique_identifiers</span></code>
        which is a collection of unique integral identifiers (see also <a href="../../../example/contracts/subcontract_identifiers.cpp" target="_top"><code class="literal">subcontract_identifiers.cpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">CONTRACT_CLASS</span><span class="special">(</span>
    <span class="keyword">class</span> <span class="special">(</span><span class="identifier">unique_identifiers</span><span class="special">)</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="identifier">CONTRACT_CLASS_INVARIANT</span><span class="special">(</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">&gt;=</span> <span class="number">0</span> <span class="special">)</span>

    <span class="identifier">CONTRACT_CONSTRUCTOR</span><span class="special">(</span>
        <span class="keyword">public</span> <span class="special">(</span><span class="identifier">unique_identifiers</span><span class="special">)</span> <span class="special">(</span> <span class="keyword">void</span> <span class="special">)</span>
            <span class="keyword">postcondition</span><span class="special">(</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="number">0</span> <span class="special">)</span>
    <span class="special">)</span> <span class="special">{}</span>

    <span class="identifier">CONTRACT_DESTRUCTOR</span><span class="special">(</span>
        <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="special">(~</span><span class="identifier">unique_identifiers</span><span class="special">)</span> <span class="special">(</span> <span class="keyword">void</span> <span class="special">)</span>
    <span class="special">)</span> <span class="special">{}</span>

    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
        <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="special">(</span><span class="identifier">add</span><span class="special">)</span> <span class="special">(</span> <span class="keyword">int</span> <span class="identifier">id</span> <span class="special">)</span>
            <span class="keyword">precondition</span><span class="special">(</span>
                <span class="comment">// Id not already present.</span>
                <span class="identifier">std</span><span class="special">::</span><span class="identifier">find</span><span class="special">(</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">end</span><span class="special">(),</span> <span class="identifier">id</span><span class="special">)</span> <span class="special">==</span> <span class="identifier">end</span><span class="special">()</span>
            <span class="special">)</span>
            <span class="keyword">postcondition</span><span class="special">(</span>
                <span class="keyword">auto</span> <span class="identifier">old_size</span> <span class="special">=</span> <span class="identifier">CONTRACT_OLDOF</span> <span class="identifier">size</span><span class="special">(),</span>
                <span class="keyword">auto</span> <span class="identifier">old_found</span> <span class="special">=</span> <span class="identifier">CONTRACT_OLDOF</span>
                        <span class="identifier">std</span><span class="special">::</span><span class="identifier">find</span><span class="special">(</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">end</span><span class="special">(),</span> <span class="identifier">id</span><span class="special">)</span> <span class="special">!=</span> <span class="identifier">end</span><span class="special">(),</span>
                <span class="comment">// If id was not already present, it was added now...</span>
                <span class="identifier">old_found</span> <span class="special">?</span> <span class="keyword">true</span> <span class="special">:</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">find</span><span class="special">(</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">end</span><span class="special">(),</span> <span class="identifier">id</span><span class="special">)</span> <span class="special">!=</span> <span class="identifier">end</span><span class="special">(),</span>
                <span class="comment">// ...and size was increased of 1.</span>
                <span class="identifier">old_found</span> <span class="special">?</span> <span class="keyword">true</span> <span class="special">:</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="identifier">old_size</span> <span class="special">+</span> <span class="number">1</span>
            <span class="special">)</span>
    <span class="special">)</span> <span class="special">{</span>
        <span class="identifier">identifiers_</span><span class="special">.</span><span class="identifier">push_back</span><span class="special">(</span><span class="identifier">id</span><span class="special">);</span>
    <span class="special">}</span>

    <span class="comment">// ...</span>
</pre>
<p>
      </p>
<p>
        Reading the contracts we can understand the semantics of the class operation
        (even if we do not consult the class implementation):
      </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
            The collection is constructed with zero size as specified by the constructor
            postconditions. Consistently, the class invariants assert that the class
            size must never be negative (but it can be zero).
          </li>
<li class="listitem">
            The member function <code class="computeroutput"><span class="identifier">unique_identifiers</span><span class="special">::</span><span class="identifier">add</span></code>
            allows to add an integral identifier to the collection. The preconditions
            assert that the specified identifier must not already be part of the
            collection making sure that duplicate identifiers are never added.
          </li>
<li class="listitem">
            If the specified identifier was not already part of the collection (<code class="computeroutput"><span class="identifier">old_found</span></code> is <code class="computeroutput"><span class="keyword">false</span></code>)
            then the postconditions assert that the identifier is added and consequently
            that the size of the collection increased by one. Note that both postconditions
            are trivially <code class="computeroutput"><span class="keyword">true</span></code> if instead
            the identifier was already part of the collection (<code class="computeroutput"><span class="identifier">old_found</span></code>
            is <code class="computeroutput"><span class="keyword">true</span></code>). We call these
            type of assertions that are "guarded" by an activation condition
            <span class="emphasis"><em>select assertions</em></span> (here we have used the C++ ternary
            operator <code class="computeroutput"><span class="special">?:</span></code> to program select
            assertions, the <a class="link" href="advanced_topics.html" title="Advanced Topics">Advanced Topics</a>
            section will introduce an alternative construct for select assertions).
          </li>
</ol></div>
<p>
        Let's assume that we want to derive from <code class="computeroutput"><span class="identifier">unique_identifiers</span></code>
        another type of collection <code class="computeroutput"><span class="identifier">duplicate_identifiers</span></code>
        which instead allows to add duplicate identifiers (see also <a href="../../../example/contracts/subcontract_identifiers.cpp" target="_top"><code class="literal">subcontract_identifiers.cpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">CONTRACT_CLASS</span><span class="special">(</span>
    <span class="keyword">class</span> <span class="special">(</span><span class="identifier">duplicate_identifiers</span><span class="special">)</span>
        <span class="keyword">extends</span><span class="special">(</span> <span class="keyword">public</span> <span class="identifier">unique_identifiers</span> <span class="special">)</span> <span class="comment">// Automatically subcontract.</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="identifier">CONTRACT_CLASS_INVARIANT</span><span class="special">(</span>
        <span class="identifier">size</span><span class="special">()</span> <span class="special">&gt;=</span> <span class="number">1</span> <span class="comment">// Strengthened inherited class invariants (in `and`).</span>
    <span class="special">)</span>

    <span class="identifier">CONTRACT_CONSTRUCTOR</span><span class="special">(</span>
        <span class="keyword">public</span> <span class="special">(</span><span class="identifier">duplicate_identifiers</span><span class="special">)</span> <span class="special">(</span> <span class="keyword">int</span> <span class="identifier">id</span> <span class="special">)</span>
            <span class="keyword">postcondition</span><span class="special">(</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="number">1</span> <span class="special">)</span>
    <span class="special">)</span> <span class="special">{</span>
        <span class="comment">// As usual, constructor should not call virtual member `add`.</span>
        <span class="identifier">identifiers_</span><span class="special">.</span><span class="identifier">push_back</span><span class="special">(</span><span class="identifier">id</span><span class="special">);</span>
    <span class="special">}</span>

    <span class="identifier">CONTRACT_DESTRUCTOR</span><span class="special">(</span>
        <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="special">(~</span><span class="identifier">duplicate_identifiers</span><span class="special">)</span> <span class="special">(</span> <span class="keyword">void</span> <span class="special">)</span>
    <span class="special">)</span> <span class="special">{}</span>

    <span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
        <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="special">(</span><span class="identifier">add</span><span class="special">)</span> <span class="special">(</span> <span class="keyword">int</span> <span class="identifier">id</span> <span class="special">)</span>
            <span class="keyword">precondition</span><span class="special">(</span> <span class="comment">// Wakened inherited preconditions (in `or`).</span>
                <span class="comment">// OK even if id is already present.</span>
                <span class="identifier">std</span><span class="special">::</span><span class="identifier">find</span><span class="special">(</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">end</span><span class="special">(),</span> <span class="identifier">id</span><span class="special">)</span> <span class="special">!=</span> <span class="identifier">end</span><span class="special">()</span>
            <span class="special">)</span>
            <span class="keyword">postcondition</span><span class="special">(</span> <span class="comment">// Strengthened inherited postconditions (in `and`).</span>
                <span class="keyword">auto</span> <span class="identifier">old_size</span> <span class="special">=</span> <span class="identifier">CONTRACT_OLDOF</span> <span class="identifier">size</span><span class="special">(),</span>
                <span class="keyword">auto</span> <span class="identifier">old_found</span> <span class="special">=</span> <span class="identifier">CONTRACT_OLDOF</span>
                        <span class="identifier">std</span><span class="special">::</span><span class="identifier">find</span><span class="special">(</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">end</span><span class="special">(),</span> <span class="identifier">id</span><span class="special">)</span> <span class="special">!=</span> <span class="identifier">end</span><span class="special">(),</span>
                <span class="comment">// Inherited postconditions not checked because of</span>
                <span class="comment">// select assertions, plus size unchanged if already present.</span>
                <span class="identifier">old_found</span> <span class="special">?</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="identifier">old_size</span> <span class="special">:</span> <span class="keyword">true</span>
            <span class="special">)</span>
    <span class="special">)</span> <span class="special">{</span>
        <span class="keyword">if</span><span class="special">(</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">find</span><span class="special">(</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">end</span><span class="special">(),</span> <span class="identifier">id</span><span class="special">)</span> <span class="special">==</span> <span class="identifier">end</span><span class="special">())</span> <span class="special">{</span> <span class="comment">// Not already present.</span>
            <span class="comment">// Unfortunately, must invoke base function via `BODY` macro.</span>
            <span class="identifier">unique_identifiers</span><span class="special">::</span><span class="identifier">CONTRACT_MEMBER_BODY</span><span class="special">(</span><span class="identifier">add</span><span class="special">)(</span><span class="identifier">id</span><span class="special">);</span>
        <span class="special">}</span>
    <span class="special">}</span>
<span class="special">};</span>
</pre>
<p>
      </p>
<p>
        The derived class <code class="computeroutput"><span class="identifier">duplicate_identifiers</span></code>
        publicly inherits from the base class <code class="computeroutput"><span class="identifier">unique_identifiers</span></code>
        using the specifier <code class="literal">extends( <span class="emphasis"><em>base1</em></span>, <span class="emphasis"><em>base2</em></span>,
        ... )</code> instead of the usual column symbol <code class="literal">: <span class="emphasis"><em>base1</em></span>,
        <span class="emphasis"><em>base2</em></span>, ...</code>. (This use of <code class="computeroutput"><span class="keyword">extends</span></code>
        resembles <a href="http://en.wikipedia.org/wiki/Java_(programming_language)" target="_top">Java</a>'s
        syntax.) As usual, the inheritance access level <code class="computeroutput"><span class="keyword">public</span></code>,
        <code class="computeroutput"><span class="keyword">protected</span></code>, or <code class="computeroutput"><span class="keyword">private</span></code> is optional and it defaults to <code class="computeroutput"><span class="keyword">public</span></code> for <code class="computeroutput"><span class="keyword">struct</span></code>
        and to <code class="computeroutput"><span class="keyword">private</span></code> for <code class="computeroutput"><span class="keyword">class</span></code>. Virtual base classes can also be specified
        but <code class="computeroutput"><span class="keyword">virtual</span></code> must always be specified
        after the inheritance access level <code class="computeroutput"><span class="keyword">public</span></code>,
        <code class="computeroutput"><span class="keyword">protected</span></code>, or <code class="computeroutput"><span class="keyword">private</span></code> if present. Multiple base classes
        (<code class="computeroutput"><span class="identifier">base1</span></code>, <code class="computeroutput"><span class="identifier">base2</span></code>,
        etc) can be specified for multiple-inheritance (the configuration macro
        <code class="computeroutput"><a class="link" href="../CONTRACT_CONFIG_INHERITANCE_MAX.html" title="Macro CONTRACT_CONFIG_INHERITANCE_MAX">CONTRACT_CONFIG_INHERITANCE_MAX</a></code>
        indicates the maximum number of base classes that can be specified).
      </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../doc/src/images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
          This library automatically subcontracts the derived class when one or more
          base classes are specified (see the <a class="link" href="contract_programming_overview.html" title="Contract Programming Overview">Contract
          Programming Overview</a> section).
        </p></td></tr>
</table></div>
<p>
        Let's assume that a <code class="computeroutput"><span class="identifier">duplicate_identifers</span></code>
        object is constructed with identifier <code class="computeroutput"><span class="number">123</span></code>
        and that we try to add the identifier <code class="computeroutput"><span class="number">123</span></code>
        again:
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">duplicate_identifiers</span> <span class="identifier">ids</span><span class="special">(</span><span class="number">123</span><span class="special">);</span>
<span class="identifier">ids</span><span class="special">.</span><span class="identifier">add</span><span class="special">(</span><span class="number">123</span><span class="special">);</span>
</pre>
<p>
      </p>
<p>
        Reading both the derived and base class contracts, we can understand the
        semantics of the derived class operation (even if we do not consult the base
        and derived class implementations):
      </p>
<div class="orderedlist"><ol class="orderedlist" type="1">
<li class="listitem">
            The <code class="computeroutput"><span class="identifier">duplicate_identifiers</span></code>
            constructor creates a collection with size one as specified by the constructor
            postconditions. Therefore, the <code class="computeroutput"><span class="identifier">duplicate_identifiers</span></code>
            class invariants assert that size is always positive. Subcontracting
            automatically checks the <code class="computeroutput"><span class="identifier">unique_identifiers</span></code>
            base class invariants in <a class="link" href="contract_programming_overview.html#logic_and_anchor">logic-and</a>
            with the <code class="computeroutput"><span class="identifier">duplicate_identifiers</span></code>
            derived class invariants thus class invariants can only be strengthened
            by derived classes (this is necessary because the derived class can be
            used whenever the base class is used therefore the derived class must
            satisfy the base class invariants at all times, see also the <a href="http://en.wikipedia.org/wiki/Liskov_substitution_principle" target="_top">substitution
            principle</a> and the <a class="link" href="contract_programming_overview.html" title="Contract Programming Overview">Contract
            Programming Overview</a> section).
          </li>
<li class="listitem">
            Subcontracting automatically checks the <code class="computeroutput"><span class="identifier">unique_identifiers</span><span class="special">::</span><span class="identifier">add</span></code>
            overridden preconditions in <a class="link" href="contract_programming_overview.html#logic_or_anchor">logic-or</a>
            with the <code class="computeroutput"><span class="identifier">duplicate_identifiers</span><span class="special">::</span><span class="identifier">add</span></code>
            overriding preconditions thus preconditions can only be weakened by overriding
            member functions (this is necessary because the overriding member function
            can be called under the conditions for which the overridden function
            is called, see also the <a href="http://en.wikipedia.org/wiki/Liskov_substitution_principle" target="_top">substitution
            principle</a> and the <a class="link" href="contract_programming_overview.html#contract__.contract_programming_overview.member_function_calls" title="Member Function Calls">Member
            Function Calls</a> section). Indeed, in this example the <code class="computeroutput"><span class="identifier">unique_identifiers</span><span class="special">::</span><span class="identifier">add</span></code> preconditions fail (because <code class="computeroutput"><span class="number">123</span></code> is already in the collection) but the
            <code class="computeroutput"><span class="identifier">derived_identifiers</span><span class="special">::</span><span class="identifier">add</span></code> preconditions pass so the <a class="link" href="contract_programming_overview.html#logic_or_anchor">logic-or</a> of the two sets of preconditions
            passes and the call <code class="computeroutput"><span class="identifier">ids</span><span class="special">.</span><span class="identifier">add</span><span class="special">(</span><span class="number">123</span><span class="special">)</span></code>
            is a valid call.
          </li>
<li class="listitem">
            Subcontracting automatically checks the <code class="computeroutput"><span class="identifier">unique_identifiers</span><span class="special">::</span><span class="identifier">add</span></code>
            overridden postconditions in <a class="link" href="contract_programming_overview.html#logic_and_anchor">logic-and</a>
            with the <code class="computeroutput"><span class="identifier">duplicate_identifiers</span><span class="special">::</span><span class="identifier">add</span></code>
            overriding postconditions thus postconditions can only be strengthen
            by overriding member functions (this is necessary because the overriding
            function can be called in any context in which the overridden function
            is called, see also the <a href="http://en.wikipedia.org/wiki/Liskov_substitution_principle" target="_top">substitution
            principle</a> and the <a class="link" href="contract_programming_overview.html#contract__.contract_programming_overview.member_function_calls" title="Member Function Calls">Member
            Function Calls</a> section). Indeed, in this example the <code class="computeroutput"><span class="identifier">unique_identifiers</span><span class="special">::</span><span class="identifier">add</span></code> postconditions pass because the
            identifier <code class="computeroutput"><span class="number">123</span></code> was already
            added (<code class="computeroutput"><span class="identifier">old_found</span></code> is
            <code class="computeroutput"><span class="keyword">true</span></code>) and <code class="computeroutput"><span class="identifier">unique_identifiers</span><span class="special">::</span><span class="identifier">add</span></code> select assertions trivially return
            <code class="computeroutput"><span class="keyword">true</span></code>. The <code class="computeroutput"><span class="identifier">duplicate_identifiers</span><span class="special">::</span><span class="identifier">add</span></code> postconditions are then checked
            in <a class="link" href="contract_programming_overview.html#logic_and_anchor">logic-and</a> and they correctly
            assert that the collection size did not change given that <code class="computeroutput"><span class="number">123</span></code> was already added. Therefore, the call
            <code class="computeroutput"><span class="identifier">ids</span><span class="special">.</span><span class="identifier">add</span><span class="special">(</span><span class="number">123</span><span class="special">)</span></code> is
            valid but adds no identifier.
          </li>
</ol></div>
<p>
        Finally, note that within the body of overriding functions it is necessary
        to use the <code class="computeroutput"><a class="link" href="../CONTRACT_MEMBER_BODY.html" title="Macro CONTRACT_MEMBER_BODY">CONTRACT_MEMBER_BODY</a></code>
        macro to call the overridden function as in <code class="computeroutput"><span class="identifier">unique_identifiers</span><span class="special">::</span><span class="identifier">CONTRACT_MEMBER_BODY</span><span class="special">(</span><span class="identifier">add</span><span class="special">)(</span><span class="identifier">id</span><span class="special">)</span></code>.
      </p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="../../../doc/src/images/warning.png"></td>
<th align="left">Warning</th>
</tr>
<tr><td align="left" valign="top"><p>
          Unfortunately, invoking the overridden function from within the overriding
          function body without using <code class="computeroutput"><a class="link" href="../CONTRACT_MEMBER_BODY.html" title="Macro CONTRACT_MEMBER_BODY">CONTRACT_MEMBER_BODY</a></code>
          results in infinite recursion. <sup>[<a name="contract__.tutorial.inheritance_and_subcontracting.f0" href="#ftn.contract__.tutorial.inheritance_and_subcontracting.f0" class="footnote">29</a>]</sup> This limitation might be removed in future revisions of this
          library (see also <a href="https://sourceforge.net/apps/trac/contractpp/ticket/46" target="_top">Ticket
          46</a>).
        </p></td></tr>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.class_templates"></a><a class="link" href="tutorial.html#contract__.tutorial.class_templates" title="Class Templates">Class Templates</a>
</h3></div></div></div>
<p>
        Let's program a class template <code class="computeroutput"><span class="identifier">vector</span></code>
        similar to the class <code class="computeroutput"><span class="identifier">ivector</span></code>
        we have seen before but that works on a generic value type <code class="computeroutput"><span class="identifier">T</span></code> and not just on <code class="computeroutput"><span class="keyword">int</span></code>
        (see also <a href="../../../example/contracts/class_template_vector.cpp" target="_top"><code class="literal">class_template_vector.cpp</code></a> and
        <a href="../../../example/contracts/pushable.hpp" target="_top"><code class="literal">pushable.hpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="string">"pushable.hpp"</span>

<span class="identifier">CONTRACT_CLASS</span><span class="special">(</span>
    <span class="keyword">template</span><span class="special">(</span> <span class="keyword">typename</span> <span class="identifier">T</span> <span class="special">)</span>
    <span class="keyword">class</span> <span class="special">(</span><span class="identifier">vector</span><span class="special">)</span> <span class="keyword">extends</span><span class="special">(</span> <span class="keyword">public</span> <span class="identifier">pushable</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="special">)</span> <span class="comment">// Subcontract.</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="comment">// Within templates, use contract macros postfixed by `_TPL`.</span>

    <span class="identifier">CONTRACT_CLASS_INVARIANT_TPL</span><span class="special">(</span>
        <span class="identifier">empty</span><span class="special">()</span> <span class="special">==</span> <span class="special">(</span><span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="number">0</span><span class="special">),</span>
        <span class="identifier">size</span><span class="special">()</span> <span class="special">&lt;=</span> <span class="identifier">capacity</span><span class="special">(),</span>
        <span class="identifier">capacity</span><span class="special">()</span> <span class="special">&lt;=</span> <span class="identifier">max_size</span><span class="special">(),</span>
        <span class="identifier">std</span><span class="special">::</span><span class="identifier">distance</span><span class="special">(</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">end</span><span class="special">())</span> <span class="special">==</span> <span class="keyword">int</span><span class="special">(</span><span class="identifier">size</span><span class="special">())</span>
    <span class="special">)</span>

    <span class="keyword">public</span><span class="special">:</span> <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">size_type</span> <span class="identifier">size_type</span><span class="special">;</span>
    <span class="keyword">public</span><span class="special">:</span> <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_reference</span> <span class="identifier">const_reference</span><span class="special">;</span>
    <span class="keyword">public</span><span class="special">:</span> <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">const_iterator</span> <span class="identifier">const_iterator</span><span class="special">;</span>

    <span class="identifier">CONTRACT_CONSTRUCTOR_TPL</span><span class="special">(</span>
        <span class="keyword">public</span> <span class="keyword">explicit</span> <span class="special">(</span><span class="identifier">vector</span><span class="special">)</span> <span class="special">(</span> <span class="special">(</span><span class="identifier">size_type</span><span class="special">)</span> <span class="identifier">count</span> <span class="special">)</span>
            <span class="keyword">precondition</span><span class="special">(</span> <span class="identifier">count</span> <span class="special">&gt;=</span> <span class="number">0</span> <span class="special">)</span>
            <span class="keyword">postcondition</span><span class="special">(</span>
                <span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="identifier">count</span><span class="special">,</span>
                <span class="identifier">boost</span><span class="special">::</span><span class="identifier">algorithm</span><span class="special">::</span><span class="identifier">all_of_equal</span><span class="special">(</span><span class="identifier">begin</span><span class="special">(),</span> <span class="identifier">end</span><span class="special">(),</span> <span class="identifier">T</span><span class="special">())</span>
            <span class="special">)</span>
            <span class="keyword">initialize</span><span class="special">(</span> <span class="identifier">vector_</span><span class="special">(</span><span class="identifier">count</span><span class="special">)</span> <span class="special">)</span>
    <span class="special">)</span> <span class="special">{}</span>

    <span class="identifier">CONTRACT_DESTRUCTOR_TPL</span><span class="special">(</span>
        <span class="keyword">public</span> <span class="keyword">virtual</span> <span class="special">(~</span><span class="identifier">vector</span><span class="special">)</span> <span class="special">(</span> <span class="keyword">void</span> <span class="special">)</span>
    <span class="special">)</span> <span class="special">{}</span>

    <span class="identifier">CONTRACT_FUNCTION_TPL</span><span class="special">(</span>
        <span class="keyword">public</span> <span class="keyword">void</span> <span class="special">(</span><span class="identifier">push_back</span><span class="special">)</span> <span class="special">(</span> <span class="special">(</span><span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;)</span> <span class="identifier">value</span> <span class="special">)</span>
            <span class="keyword">precondition</span><span class="special">(</span> <span class="identifier">size</span><span class="special">()</span> <span class="special">&lt;</span> <span class="identifier">max_size</span><span class="special">()</span> <span class="special">)</span>
            <span class="keyword">postcondition</span><span class="special">(</span>
                <span class="keyword">auto</span> <span class="identifier">old_size</span> <span class="special">=</span> <span class="identifier">CONTRACT_OLDOF</span> <span class="identifier">size</span><span class="special">(),</span>
                <span class="keyword">auto</span> <span class="identifier">old_capacity</span> <span class="special">=</span> <span class="identifier">CONTRACT_OLDOF</span> <span class="identifier">capacity</span><span class="special">(),</span>
                <span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="identifier">old_size</span> <span class="special">+</span> <span class="number">1</span><span class="special">,</span>
                <span class="identifier">capacity</span><span class="special">()</span> <span class="special">&gt;=</span> <span class="identifier">old_capacity</span>
                <span class="comment">// Overridden postconditions also check `back() == value`.</span>
            <span class="special">)</span>
    <span class="special">)</span> <span class="special">{</span>
        <span class="identifier">vector_</span><span class="special">.</span><span class="identifier">push_back</span><span class="special">(</span><span class="identifier">value</span><span class="special">);</span>
    <span class="special">}</span>

    <span class="comment">// ...</span>
</pre>
<p>
      </p>
<p>
        (The specifications of the code in this example are not fully programmed,
        in particular concepts, see the <a class="link" href="concepts.html" title="Concepts">Concepts</a>
        section, and assertion requirements, see the <a class="link" href="advanced_topics.html" title="Advanced Topics">Advanced
        Topics</a> section, have been omitted for simplicity.)
      </p>
<p>
        Note that templates are declared using the specifier <code class="computeroutput"><span class="keyword">template</span><span class="special">(</span> <span class="keyword">typename</span> <span class="identifier">T</span><span class="special">,</span> <span class="special">...</span>
        <span class="special">)</span></code> which uses round parenthesis instead
        of the usual angular parenthesis <code class="computeroutput"><span class="keyword">template</span><span class="special">&lt;</span> <span class="keyword">typename</span> <span class="identifier">T</span><span class="special">,</span> <span class="special">...</span>
        <span class="special">&gt;</span></code>. However, after a template is
        declared using round parenthesis, angular parenthesis are used as usual to
        instantiate the template (e.g., the base class <code class="computeroutput"><span class="identifier">pushable</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span></code>).
      </p>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../../../doc/src/images/important.png"></td>
<th align="left">Important</th>
</tr>
<tr><td align="left" valign="top"><p>
          Within a type-dependent scope (e.g., within the class template of the above
          example) the special macros with the <code class="computeroutput"><span class="identifier">_TPL</span></code>
          postfix must be used instead of the macros we have seen so far. <sup>[<a name="contract__.tutorial.class_templates.f0" href="#ftn.contract__.tutorial.class_templates.f0" class="footnote">30</a>]</sup> (The same applies to function templates, see below.)
        </p></td></tr>
</table></div>
<p>
        In the example above, the enclosing class template <code class="computeroutput"><span class="identifier">vector</span></code>
        is not declared using the <code class="computeroutput"><a class="link" href="../CONTRACT_CLASS_TPL.html" title="Macro CONTRACT_CLASS_TPL">CONTRACT_CLASS_TPL</a></code>
        macro because its enclosing scope is not type-dependent (it is the global
        namespace). Within such a class template however, all contract macros must
        use the <code class="computeroutput"><span class="identifier">_TPL</span></code> postfix so
        <code class="computeroutput"><a class="link" href="../CONTRACT_CLASS_INVARIANT_TPL.html" title="Macro CONTRACT_CLASS_INVARIANT_TPL">CONTRACT_CLASS_INVARIANT_TPL</a></code>,
        <code class="computeroutput"><a class="link" href="../CONTRACT_CONSTRUCTOR_TPL.html" title="Macro CONTRACT_CONSTRUCTOR_TPL">CONTRACT_CONSTRUCTOR_TPL</a></code>,
        <code class="computeroutput"><a class="link" href="../CONTRACT_DESTRUCTOR_TPL.html" title="Macro CONTRACT_DESTRUCTOR_TPL">CONTRACT_DESTRUCTOR_TPL</a></code>,
        and <code class="computeroutput"><a class="link" href="../CONTRACT_FUNCTION_TPL.html" title="Macro CONTRACT_FUNCTION_TPL">CONTRACT_FUNCTION_TPL</a></code>
        must be used to specify class invariants, declare constructors, declare the
        destructor, and declare member functions respectively. In general, the <code class="computeroutput"><a class="link" href="../CONTRACT_CLASS_TPL.html" title="Macro CONTRACT_CLASS_TPL">CONTRACT_CLASS_TPL</a></code> macro is used when
        declaring a class nested within a class template (see the <a class="link" href="advanced_topics.html" title="Advanced Topics">Advanced
        Topics</a> section).
      </p>
<p>
        This libraries supports all the different kinds of template parameters that
        C++ supports: type template parameters, value template parameters, and template
        template parameters.
      </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
            Type template parameters can be prefixed by either <code class="computeroutput"><span class="keyword">typename</span></code>
            or <code class="computeroutput"><span class="keyword">class</span></code> as usual, <code class="computeroutput"><span class="keyword">typename</span> <span class="identifier">A</span></code>
            or <code class="computeroutput"><span class="keyword">class</span> <span class="identifier">C</span></code>.
          </li>
<li class="listitem">
            The type of value template parameters must be wrapped within parenthesis
            <code class="computeroutput"><span class="special">(</span><span class="identifier">A</span><span class="special">)</span> <span class="identifier">D</span></code>
            but the parenthesis are optional for fundamental types that contain no
            symbol <code class="computeroutput"><span class="keyword">int</span> <span class="identifier">B</span></code>.
          </li>
<li class="listitem">
            Template template parameters use round parenthesis for their template
            specifier but then their inner template parameters are specified using
            the usual C++ syntax <code class="computeroutput"><span class="keyword">template</span><span class="special">(</span> <span class="keyword">typename</span> <span class="identifier">X</span><span class="special">,</span> <span class="keyword">template</span><span class="special">&lt;</span>
            <span class="special">...</span> <span class="special">&gt;</span>
            <span class="keyword">class</span> <span class="identifier">Y</span><span class="special">,</span> <span class="special">...</span> <span class="special">)</span> <span class="keyword">class</span> <span class="identifier">E</span></code>.
          </li>
</ul></div>
<p>
        Default template parameters are specified using <code class="computeroutput"><span class="special">,</span>
        <span class="keyword">default</span> </code><code class="literal"><span class="emphasis"><em>default-value</em></span></code>
        right after the template parameter declaration. For example (see also <a href="../../../example/contracts/template_params.cpp" target="_top"><code class="literal">template_params.cpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">CONTRACT_CLASS</span><span class="special">(</span> <span class="comment">// Class template parameters.</span>
    <span class="keyword">template</span><span class="special">(</span>
          <span class="keyword">typename</span> <span class="identifier">A</span>            <span class="comment">// Type template parameter.</span>
        <span class="special">,</span> <span class="keyword">int</span> <span class="identifier">B</span>                 <span class="comment">// Value template parameter.</span>
        <span class="special">,</span> <span class="keyword">class</span> <span class="identifier">C</span><span class="special">,</span> <span class="keyword">default</span> <span class="identifier">A</span>    <span class="comment">// Optional type template parameter.</span>
        <span class="special">,</span> <span class="special">(</span><span class="identifier">A</span><span class="special">)</span> <span class="identifier">D</span><span class="special">,</span> <span class="keyword">default</span> <span class="identifier">B</span>      <span class="comment">// Optional value template parameter.</span>
        <span class="special">,</span> <span class="keyword">template</span><span class="special">(</span>             <span class="comment">// Template template parameter: Outer template</span>
              <span class="keyword">typename</span> <span class="identifier">X</span>        <span class="comment">// uses `()` but rest uses usual syntax.</span>
            <span class="special">,</span> <span class="keyword">template</span><span class="special">&lt;</span> <span class="keyword">typename</span> <span class="identifier">S</span><span class="special">,</span> <span class="keyword">typename</span> <span class="identifier">T</span> <span class="special">=</span> <span class="identifier">S</span> <span class="special">&gt;</span> <span class="keyword">class</span> <span class="identifier">Y</span>
            <span class="special">,</span> <span class="keyword">class</span> <span class="identifier">Z</span> <span class="special">=</span> <span class="keyword">int</span>
            <span class="special">,</span> <span class="identifier">Z</span> <span class="identifier">V</span> <span class="special">=</span> <span class="number">0</span>
          <span class="special">)</span> <span class="keyword">class</span> <span class="identifier">E</span><span class="special">,</span> <span class="keyword">default</span> <span class="identifier">x</span>  <span class="comment">// Optional template template parameter.</span>
    <span class="special">)</span>
    <span class="keyword">struct</span> <span class="special">(</span><span class="identifier">a</span><span class="special">)</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="comment">// ...</span>
</pre>
<p>
      </p>
<p>
        Finally, the syntax <code class="computeroutput"><span class="keyword">template</span><span class="special">(</span> <span class="keyword">void</span> <span class="special">)</span></code>
        is used instead of the usual <code class="computeroutput"><span class="keyword">template</span><span class="special">&lt;</span> <span class="special">&gt;</span></code>
        to specify a template with no template parameters (this is typically used
        for template specializations, see the <a class="link" href="advanced_topics.html" title="Advanced Topics">Advanced
        Topics</a> section).
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.function_templates"></a><a class="link" href="tutorial.html#contract__.tutorial.function_templates" title="Function Templates">Function Templates</a>
</h3></div></div></div>
<p>
        Let's program a function template <code class="computeroutput"><span class="identifier">postinc</span></code>
        similar to the function <code class="computeroutput"><span class="identifier">postinc</span></code>
        that we have seen before but that works on a generic type <code class="computeroutput"><span class="identifier">T</span></code>
        and not just on <code class="computeroutput"><span class="keyword">int</span></code> (see also
        <a href="../../../example/contracts/function_template_postinc.cpp" target="_top"><code class="literal">function_template_postinc.cpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
    <span class="keyword">template</span><span class="special">(</span> <span class="keyword">typename</span> <span class="identifier">T</span> <span class="special">)</span> <span class="comment">// Template parameter(s).</span>
    <span class="special">(</span><span class="identifier">T</span> <span class="keyword">const</span><span class="special">)</span> <span class="special">(</span><span class="identifier">postinc</span><span class="special">)</span> <span class="special">(</span> <span class="special">(</span><span class="identifier">T</span><span class="special">&amp;)</span> <span class="identifier">value</span> <span class="special">)</span>
        <span class="keyword">precondition</span><span class="special">(</span> <span class="identifier">value</span> <span class="special">&lt;</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">numeric_limits</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">max</span><span class="special">()</span> <span class="special">)</span>
        <span class="keyword">postcondition</span><span class="special">(</span>
            <span class="keyword">auto</span> <span class="identifier">result</span> <span class="special">=</span> <span class="keyword">return</span><span class="special">,</span>
            <span class="keyword">auto</span> <span class="identifier">old_value</span> <span class="special">=</span> <span class="identifier">CONTRACT_OLDOF</span> <span class="identifier">value</span><span class="special">,</span>
            <span class="identifier">value</span> <span class="special">==</span> <span class="identifier">old_value</span> <span class="special">+</span> <span class="number">1</span><span class="special">,</span>
            <span class="identifier">result</span> <span class="special">==</span> <span class="identifier">old_value</span>
        <span class="special">)</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="keyword">return</span> <span class="identifier">value</span><span class="special">++;</span>
<span class="special">}</span>
</pre>
<p>
      </p>
<p>
        (The specifications of the code in this example are not fully programmed,
        in particular concepts, see the <a class="link" href="concepts.html" title="Concepts">Concepts</a>
        section, and assertion requirements, see the <a class="link" href="advanced_topics.html" title="Advanced Topics">Advanced
        Topics</a> section, have been omitted for simplicity.)
      </p>
<p>
        Type, value, and template template parameters are specified for function
        templates using the same syntax used for class template parameters, for example
        (see also <a href="../../../example/contracts/template_params.cpp" target="_top"><code class="literal">template_params.cpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="comment">// Function template parameters.</span>
    <span class="keyword">template</span><span class="special">(</span> <span class="comment">// As usual, no default template parameters allowed in functions.</span>
          <span class="keyword">typename</span> <span class="identifier">A</span>            <span class="comment">// Type template parameter.</span>
        <span class="special">,</span> <span class="keyword">int</span> <span class="identifier">B</span>                 <span class="comment">// Value template parameter.</span>
        <span class="special">,</span> <span class="keyword">class</span> <span class="identifier">C</span>               <span class="comment">// Type template parameter.</span>
        <span class="special">,</span> <span class="special">(</span><span class="identifier">A</span><span class="special">)</span> <span class="identifier">D</span>                 <span class="comment">// Value template parameter.</span>
        <span class="special">,</span> <span class="keyword">template</span><span class="special">(</span>             <span class="comment">// Template template parameter: Outer template</span>
              <span class="keyword">typename</span> <span class="identifier">X</span>        <span class="comment">// uses `()` but rest uses usual syntax.</span>
            <span class="special">,</span> <span class="keyword">template</span><span class="special">&lt;</span> <span class="keyword">typename</span> <span class="identifier">S</span><span class="special">,</span> <span class="keyword">typename</span> <span class="identifier">T</span> <span class="special">=</span> <span class="identifier">S</span> <span class="special">&gt;</span> <span class="keyword">class</span> <span class="identifier">Y</span>
            <span class="special">,</span> <span class="keyword">class</span> <span class="identifier">Z</span> <span class="special">=</span> <span class="keyword">int</span>
            <span class="special">,</span> <span class="identifier">Z</span> <span class="identifier">V</span> <span class="special">=</span> <span class="number">0</span>
          <span class="special">)</span> <span class="keyword">class</span> <span class="identifier">E</span>
    <span class="special">)</span>
    <span class="keyword">void</span> <span class="special">(</span><span class="identifier">f</span><span class="special">)</span> <span class="special">(</span> <span class="keyword">void</span> <span class="special">)</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="comment">// ...</span>
</pre>
<p>
      </p>
<p>
        Note that as usual, function templates cannot have default template parameters
        in <a href="http://en.wikipedia.org/wiki/C%2B%2B" target="_top">C++03</a>.
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="contract__.tutorial.forward_declarations_and_body_definitions"></a><a class="link" href="tutorial.html#contract__.tutorial.forward_declarations_and_body_definitions" title="Forward Declarations and Body Definitions">Forward
      Declarations and Body Definitions</a>
</h3></div></div></div>
<p>
        This library supports contracts for classes and functions that have forward
        declarations. Furthermore, the function body definition can be deferred and
        separated from the function declaration and its contracts. For example (see
        also <a href="../../../example/contracts/body_natural.hpp" target="_top"><code class="literal">body_natural.hpp</code></a>,
        <a href="../../../example/contracts/body_natural_impl.hpp" target="_top"><code class="literal">body_natural_impl.hpp</code></a>,
        and <a href="../../../example/contracts/body_natural.cpp" target="_top"><code class="literal">body_natural.cpp</code></a>):
      </p>
<p>
</p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span> <span class="keyword">typename</span> <span class="identifier">T</span><span class="special">,</span> <span class="identifier">T</span> <span class="identifier">Default</span> <span class="special">=</span> <span class="identifier">T</span><span class="special">()</span> <span class="special">&gt;</span> <span class="comment">// Class forward declaration.</span>
<span class="keyword">class</span> <span class="identifier">natural</span> <span class="special">;</span>

<span class="keyword">template</span><span class="special">&lt;</span> <span class="keyword">typename</span> <span class="identifier">T</span> <span class="special">&gt;</span> <span class="comment">// Function forward declaration.</span>
<span class="keyword">bool</span> <span class="identifier">less</span> <span class="special">(</span> <span class="identifier">natural</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">left</span><span class="special">,</span> <span class="identifier">natural</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">right</span> <span class="special">)</span> <span class="special">;</span>

<span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span>
    <span class="keyword">template</span><span class="special">(</span> <span class="keyword">typename</span> <span class="identifier">T</span> <span class="special">)</span>
    <span class="keyword">bool</span> <span class="special">(</span><span class="identifier">greater</span><span class="special">)</span> <span class="special">(</span> <span class="special">(</span><span class="identifier">natural</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="keyword">const</span><span class="special">&amp;)</span> <span class="identifier">left</span><span class="special">,</span> <span class="special">(</span><span class="identifier">natural</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="keyword">const</span><span class="special">&amp;)</span> <span class="identifier">right</span> <span class="special">)</span>
        <span class="keyword">postcondition</span><span class="special">(</span>
            <span class="keyword">auto</span> <span class="identifier">result</span> <span class="special">=</span> <span class="keyword">return</span><span class="special">,</span>
            <span class="identifier">result</span> <span class="special">?</span> <span class="keyword">not</span> <span class="identifier">less</span><span class="special">(</span><span class="identifier">left</span><span class="special">,</span> <span class="identifier">right</span><span class="special">)</span> <span class="special">:</span> <span class="keyword">true</span>
        <span class="special">)</span>
<span class="special">)</span> <span class="special">;</span> <span class="comment">// Deferred free function body definition, use `;`.</span>

<span class="identifier">CONTRACT_CLASS</span><span class="special">(</span> <span class="comment">// Class declaration (with contracts).</span>
    <span class="keyword">template</span><span class="special">(</span> <span class="keyword">typename</span> <span class="identifier">T</span><span class="special">,</span> <span class="special">(</span><span class="identifier">T</span><span class="special">)</span> <span class="identifier">Default</span> <span class="special">)</span>
    <span class="keyword">class</span> <span class="special">(</span><span class="identifier">natural</span><span class="special">)</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="identifier">CONTRACT_CLASS_INVARIANT_TPL</span><span class="special">(</span> <span class="identifier">get</span><span class="special">()</span> <span class="special">&gt;=</span> <span class="number">0</span> <span class="special">)</span>

    <span class="identifier">CONTRACT_CONSTRUCTOR_TPL</span><span class="special">(</span>
        <span class="keyword">public</span> <span class="keyword">explicit</span> <span class="special">(</span><span class="identifier">natural</span><span class="special">)</span> <span class="special">(</span> <span class="special">(</span><span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;)</span> <span class="identifier">value</span><span class="special">,</span> <span class="keyword">default</span> <span class="identifier">Default</span> <span class="special">)</span>
            <span class="keyword">precondition</span><span class="special">(</span> <span class="identifier">value</span> <span class="special">&gt;=</span> <span class="number">0</span> <span class="special">)</span>
            <span class="keyword">postcondition</span><span class="special">(</span> <span class="identifier">get</span><span class="special">()</span> <span class="special">==</span> <span class="identifier">value</span> <span class="special">)</span>
            <span class="comment">// Unfortunately, no member initializers when body deferred.</span>
    <span class="special">)</span> <span class="special">;</span> <span class="comment">// Deferred constructor body definition, use `;`.</span>

    <span class="identifier">CONTRACT_DESTRUCTOR_TPL</span><span class="special">(</span>
        <span class="keyword">public</span> <span class="special">(~</span><span class="identifier">natural</span><span class="special">)</span> <span class="special">(</span> <span class="keyword">void</span> <span class="special">)</span>
    <span class="special">)</span> <span class="special">;</span> <span class="comment">// Deferred destructor body definition, use `;`.</span>

    <span class="identifier">CONTRACT_FUNCTION_TPL</span><span class="special">(</span>
        <span class="keyword">public</span> <span class="keyword">bool</span> <span class="special">(</span><span class="identifier">equal</span><span class="special">)</span> <span class="special">(</span> <span class="special">(</span><span class="identifier">natural</span> <span class="keyword">const</span><span class="special">&amp;)</span> <span class="identifier">right</span> <span class="special">)</span> <span class="keyword">const</span>
            <span class="keyword">postcondition</span><span class="special">(</span>
                <span class="keyword">auto</span> <span class="identifier">result</span> <span class="special">=</span> <span class="keyword">return</span><span class="special">,</span>
                <span class="identifier">result</span> <span class="special">==</span> <span class="keyword">not</span> <span class="identifier">less</span><span class="special">(*</span><span class="keyword">this</span><span class="special">,</span> <span class="identifier">right</span><span class="special">)</span> <span class="special">&amp;&amp;</span> <span class="keyword">not</span> <span class="identifier">greater</span><span class="special">(*</span><span class="keyword">this</span><span class="special">,</span> <span class="identifier">right</span><span class="special">)</span>
            <span class="special">)</span>
    <span class="special">)</span> <span class="special">;</span> <span class="comment">// Deferred member function body definition, use `;`.</span>

    <span class="identifier">CONTRACT_FUNCTION_TPL</span><span class="special">(</span>
        <span class="keyword">public</span> <span class="special">(</span><span class="identifier">T</span><span class="special">)</span> <span class="special">(</span><span class="identifier">get</span><span class="special">)</span> <span class="special">(</span> <span class="keyword">void</span> <span class="special">)</span> <span class="keyword">const</span>
    <span class="special">)</span> <span class="special">{</span>
        <span class="keyword">return</span> <span class="identifier">value_</span><span class="special">;</span>
    <span class="special">}</span>

    <span class="keyword">private</span><span class="special">:</span> <span class="identifier">T</span> <span class="identifier">value_</span><span class="special">;</span>
<span class="special">};</span>

<span class="identifier">CONTRACT_FUNCTION</span><span class="special">(</span> <span class="comment">// Function declaration (with contracts).</span>
    <span class="keyword">template</span><span class="special">(</span> <span class="keyword">typename</span> <span class="identifier">T</span> <span class="special">)</span>
    <span class="keyword">bool</span> <span class="special">(</span><span class="identifier">less</span><span class="special">)</span> <span class="special">(</span> <span class="special">(</span><span class="identifier">natural</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="keyword">const</span><span class="special">&amp;)</span> <span class="identifier">left</span><span class="special">,</span> <span class="special">(</span><span class="identifier">natural</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="keyword">const</span><span class="special">&amp;)</span> <span class="identifier">right</span> <span class="special">)</span>
        <span class="keyword">postcondition</span><span class="special">(</span>
            <span class="keyword">auto</span> <span class="identifier">result</span> <span class="special">=</span> <span class="keyword">return</span><span class="special">,</span>
            <span class="identifier">result</span> <span class="special">?</span> <span class="keyword">not</span> <span class="identifier">greater</span><span class="special">(</span><span class="identifier">left</span><span class="special">,</span> <span class="identifier">right</span><span class="special">)</span> <span class="special">:</span> <span class="keyword">true</span>
        <span class="special">)</span>
<span class="special">)</span> <span class="special">{</span>
    <span class="keyword">return</span> <span class="identifier">left</span><span class="special">.</span><span class="identifier">get</span><span class="special">()</span> <span class="special">&lt;</span> <span class="identifier">right</span><span class="special">.</span><span class="identifier">get</span><span class="special">();</span>
<span class="special">}</span>
</pre>
<p>
      </p>
<p>
        In this example, the class <code class="computeroutput"><span class="identifier">natural</span></code>
        and the function <code class="computeroutput"><span class="identifier">less</span></code> are
        first forward declared and later declared. Note that the contracts can be
        specified only once and together with the class or function declaration (not
        with the forward declarations that can be many).
      </p>
<div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../../../doc/src/images/important.png"></td>
<th align="left">Important</th>
</tr>
<tr><td align="left" valign="top"><p>
          This library forces to specify contracts with the function and class declarations
          and not with their definitions. This is correct because contracts are part
          of the program specifications (declarations) and not of the program implementation
          (definitions), see also the <a class="link" href="contract_programming_overview.html#contract__.contract_programming_overview.specification_vs__implementation" title="Specification vs. Implementation">Specification
          vs. Implementation</a> section.
        </p></td></tr>
</table></div>
<p>
        Note that as usual in C++, not all functions need to be defined when they
        are first declared. In this example, <code class="computeroutput"><span class="identifier">less</span></code>
        and <code class="computeroutput"><span class="identifier">natural</span><span class="special">::</span><span class="identifier">get</span></code> are defined together with their declarations
        and contracts while the other function bodies are defined separately.
      </p>
<p>
        The definitions of the free function <code class="computeroutput"><span class="identifier">greater</span></code>,
        the constructor <code class="computeroutput"><span class="identifier">natural</span><span class="special">::</span><span class="identifier">natural</span></code>, the destructor <code class="computeroutput"><span class="identifier">natural</span><span class="special">::~</span><span class="identifier">natural</span></code>,
        and the member function <code class="computeroutput"><span class="identifier">natural</span><span class="special">::</span><span class="identifier">equal</span></code>
        are deferred and separated from their declarations and contracts. In fact,
        a semicolon <code class="computeroutput"><span class="special">;</span></code> is specified right
        after the contract declaration macros instead of programming the function
        bodies. As usual in C++, the semicolon <code class="computeroutput"><span class="special">;</span></code>
        indicates that the function body definition is deferred and it will appear
        at some other point in the program (often in a <code class="literal">.cpp</code> file
        that can be compiled separately). In this example, the deferred functions
        are templates or template members therefore the definitions where programmed
        in a header file that must be made available when the template declarations
        are compiled (see also <a href="../../../example/contracts/body_natural_impl.hpp" target="_top"><code class="literal">body_natural_impl.hpp</code></a>):
        <sup>[<a name="contract__.tutorial.forward_declarations_and_body_definitions.f0" href="#ftn.contract__.tutorial.forward_declarations_and_body_definitions.f0" class="footnote">31</a>]</sup>
      </p>
<p>
</p>
<pre class="programlisting"><span class="comment">// Deferred body definitions, separated from their declarations and contracts.</span>

<span class="keyword">template</span><span class="special">&lt;</span> <span class="keyword">typename</span> <span class="identifier">T</span> <span class="special">&gt;</span>
<span class="keyword">bool</span> <span class="identifier">CONTRACT_FREE_BODY</span><span class="special">(</span><span class="identifier">greater</span><span class="special">)</span> <span class="special">(</span>
        <span class="identifier">natural</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">left</span><span class="special">,</span> <span class="identifier">natural</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">right</span> <span class="special">)</span>
<span class="special">{</span>
    <span class="keyword">return</span> <span class="identifier">left</span><span class="special">.</span><span class="identifier">get</span><span class="special">()</span> <span class="special">&gt;</span> <span class="identifier">right</span><span class="special">.</span><span class="identifier">get</span><span class="special">();</span>
<span class="special">}</span>

<span class="keyword">template</span><span class="special">&lt;</span> <span class="keyword">typename</span> <span class="identifier">T</span><span class="special">,</span> <span class="identifier">T</span> <span class="identifier">Default</span> <span class="special">&gt;</span>
<span class="identifier">CONTRACT_CONSTRUCTOR_BODY</span><span class="special">((</span><span class="identifier">natural</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">,</span> <span class="identifier">Default</span><span class="special">&gt;),</span> <span class="identifier">natural</span><span class="special">)</span> <span class="special">(</span> <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">value</span> <span class="special">)</span>
<span class="special">{</span>
    <span class="identifier">value_</span> <span class="special">=</span> <span class="identifier">value</span><span class="special">;</span>
<span class="special">}</span>

<span class="keyword">template</span><span class="special">&lt;</span> <span class="keyword">typename</span> <span class="identifier">T</span><span class="special">,</span> <span class="identifier">T</span> <span class="identifier">Default</span> <span class="special">&gt;</span>
<span class="identifier">CONTRACT_DESTRUCTOR_BODY</span><span class="special">((</span><span class="identifier">natural</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">,</span> <span class="identifier">Default</span><span class="special">&gt;),</span> <span class="special">~</span><span class="identifier">natural</span><span class="special">)</span> <span class="special">(</span> <span class="keyword">void</span> <span class="special">)</span>
<span class="special">{</span>
    <span class="comment">// Do nothing.</span>
<span class="special">}</span>

<span class="keyword">template</span><span class="special">&lt;</span> <span class="keyword">typename</span> <span class="identifier">T</span><span class="special">,</span> <span class="identifier">T</span> <span class="identifier">Default</span> <span class="special">&gt;</span>
<span class="keyword">bool</span> <span class="identifier">natural</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">,</span> <span class="identifier">Default</span><span class="special">&gt;::</span><span class="identifier">CONTRACT_MEMBER_BODY</span><span class="special">(</span><span class="identifier">equal</span><span class="special">)</span> <span class="special">(</span> <span class="identifier">natural</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">right</span> <span class="special">)</span>
        <span class="keyword">const</span>
<span class="special">{</span>
    <span class="keyword">return</span> <span class="keyword">not</span> <span class="identifier">less</span><span class="special">(*</span><span class="keyword">this</span><span class="special">,</span> <span class="identifier">right</span><span class="special">)</span> <span class="special">&amp;&amp;</span> <span class="keyword">not</span> <span class="identifier">greater</span><span class="special">(*</span><span class="keyword">this</span><span class="special">,</span> <span class="identifier">right</span><span class="special">);</span>
<span class="special">}</span>
</pre>
<p>
      </p>
<p>
        The usual C++ syntax is used to define the bodies (in fact this library only
        alters the syntax of class and function declarations but not the syntax of
        their definitions). However, free function, constructor, destructor, and
        member function names must be specified using the macros <code class="computeroutput"><a class="link" href="../CONTRACT_FREE_BODY.html" title="Macro CONTRACT_FREE_BODY">CONTRACT_FREE_BODY</a></code>,
        <code class="computeroutput"><a class="link" href="../CONTRACT_CONSTRUCTOR_BODY.html" title="Macro CONTRACT_CONSTRUCTOR_BODY">CONTRACT_CONSTRUCTOR_BODY</a></code>,
        <code class="computeroutput"><a class="link" href="../CONTRACT_DESTRUCTOR_BODY.html" title="Macro CONTRACT_DESTRUCTOR_BODY">CONTRACT_DESTRUCTOR_BODY</a></code>,
        and <code class="computeroutput"><a class="link" href="../CONTRACT_MEMBER_BODY.html" title="Macro CONTRACT_MEMBER_BODY">CONTRACT_MEMBER_BODY</a></code>
        respectively. <sup>[<a name="contract__.tutorial.forward_declarations_and_body_definitions.f1" href="#ftn.contract__.tutorial.forward_declarations_and_body_definitions.f1" class="footnote">32</a>]</sup> The free and member body macros take one parameter which is the
        function name. The constructor and destructor body macros take two parameters
        that are the fully qualified class type (including eventual template parameters
        as usual) and the class name which must be prefixed by the tilde symbol
        <code class="computeroutput"><span class="special">~</span></code> for destructors as usual.
        <sup>[<a name="contract__.tutorial.forward_declarations_and_body_definitions.f2" href="#ftn.contract__.tutorial.forward_declarations_and_body_definitions.f2" class="footnote">33</a>]</sup> The class type parameter must be wrapped within extra parenthesis
        like in this example but only if it contains multiple template parameters
        (because these use unwrapped commas which cannot be passed within macro parameters,
        see the beginning of the <a class="link" href="advanced_topics.html" title="Advanced Topics">Advanced
        Topics</a> section).
      </p>
<p>
        In this example, it was possible to separate the constructor body definition
        because the constructor did not specify member initializers.
      </p>
<div class="warning"><table border="0" summary="Warning">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Warning]" src="../../../doc/src/images/warning.png"></td>
<th align="left">Warning</th>
</tr>
<tr><td align="left" valign="top"><p>
          Unfortunately, when member initializers are specified, the macro <code class="computeroutput"><a class="link" href="../CONTRACT_CONSTRUCTOR_BODY.html" title="Macro CONTRACT_CONSTRUCTOR_BODY">CONTRACT_CONSTRUCTOR_BODY</a></code> cannot
          be used, the constructor body definition cannot be deferred, and the constructor
          body must be defined together with the constructor declaration and its
          contract inside the class definition. <sup>[<a name="contract__.tutorial.forward_declarations_and_body_definitions.f3" href="#ftn.contract__.tutorial.forward_declarations_and_body_definitions.f3" class="footnote">34</a>]</sup>
        </p></td></tr>
</table></div>
</div>
<div class="footnotes">
<br><hr width="100" align="left">
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.free_functions.f0" href="#contract__.tutorial.free_functions.f0" class="para">15</a>] </sup>
          In the examples presented in this documentation, extra parenthesis are
          in general avoided unless strictly required (for example, extra parenthesis
          around fundamental types containing no symbol <code class="computeroutput"><span class="keyword">void</span></code>,
          <code class="computeroutput"><span class="keyword">bool</span></code>, <code class="computeroutput"><span class="keyword">unsigned</span>
          <span class="keyword">int</span> <span class="keyword">const</span></code>,
          etc are always omitted). In the authors' opinion, the syntax is more readable
          with lesser parenthesis. However, other programmers might find it more
          readable to always specify extra parenthesis around result and parameter
          types for consistency even when they are not strictly required.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.free_functions.f1" href="#contract__.tutorial.free_functions.f1" class="para">16</a>] </sup>
            <span class="bold"><strong>Rationale.</strong></span> This library uses preprocessor
            meta-programming to parse declarations and contracts of classes and functions.
            The preprocessor cannot parse a token if it is not known a priori or
            if it contains symbols, unless such a token is wrapped within round parenthesis
            <code class="computeroutput"><span class="special">()</span></code>. For example, the function
            name is arbitrary, it cannot be known a priori, so it must always be
            wrapped within parenthesis. If a type is a fundamental type then it is
            known a priori (because it is composed of known C++ keywords <code class="computeroutput"><span class="keyword">int</span></code>, <code class="computeroutput"><span class="keyword">const</span></code>,
            <code class="computeroutput"><span class="keyword">unsigned</span></code>, etc), and if the
            fundamental type also contains no symbols (<code class="computeroutput"><span class="special">&amp;</span></code>,
            <code class="computeroutput"><span class="special">*</span></code>, etc) then the parenthesis
            around such a type are optional.
          </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.free_functions.f2" href="#contract__.tutorial.free_functions.f2" class="para">17</a>] </sup>
          <span class="bold"><strong>Rationale.</strong></span> It would be possible to modify
          the library syntax to make parameter names optional but that will complicate
          the library implementation without adding any feature for programmers.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.free_functions.f3" href="#contract__.tutorial.free_functions.f3" class="para">18</a>] </sup>
          <span class="bold"><strong>Rationale.</strong></span> Unfortunately, it is not possible
          to specify an empty parameter list simply as <code class="literal"><span class="emphasis"><em>result-type
          function-name </em></span></code><code class="computeroutput"><span class="special">(</span>
          <span class="special">)</span></code> because the preprocessor can only
          parse <code class="computeroutput"><span class="special">(</span> <span class="special">)</span></code>
          if empty macro parameters are supported. Empty macro parameters together
          with variadic macros where added to <a href="http://en.wikipedia.org/wiki/C99" target="_top">C99</a>
          and the preferred syntax of this library uses variadic macros. However,
          not all compilers (notably MSVC) that support variadic macros also correctly
          support empty macro parameters so <code class="computeroutput"><span class="special">(</span>
          <span class="keyword">void</span> <span class="special">)</span></code>
          is always used instead of <code class="computeroutput"><span class="special">(</span> <span class="special">)</span></code> to increase portability.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.free_functions.f4" href="#contract__.tutorial.free_functions.f4" class="para">19</a>] </sup>
          Note that the <code class="computeroutput"><span class="keyword">auto</span></code> storage
          classifier in deprecated by <a href="http://en.wikipedia.org/wiki/C%2B%2B11" target="_top">C++11</a>
          so it should be used with the usual care when writing programs that should
          be portable from <a href="http://en.wikipedia.org/wiki/C%2B%2B" target="_top">C++03</a>
          to <a href="http://en.wikipedia.org/wiki/C%2B%2B11" target="_top">C++11</a>.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.free_functions.f5" href="#contract__.tutorial.free_functions.f5" class="para">20</a>] </sup>
          An MSVC preprocessor bug requires to use at least one space or newline
          to separate a parameter name from its type even when the parameter type
          is wrapped within parenthesis.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.postconditions__result_and_old_values_.f0" href="#contract__.tutorial.postconditions__result_and_old_values_.f0" class="para">21</a>] </sup>
          <span class="bold"><strong>Rationale.</strong></span> The <a href="http://en.wikipedia.org/wiki/C%2B%2B11" target="_top">C++11</a>
          <code class="computeroutput"><span class="keyword">auto</span></code> declaration syntax is
          adopted for postcondition return value declarations however this library
          knows the result type because it is specified in the function declaration
          within the macros so no type deduction is actually used to implement auto
          declarations of return values. Similarly, the <a href="http://en.wikipedia.org/wiki/C%2B%2B11" target="_top">C++11</a>
          <code class="computeroutput"><span class="keyword">auto</span></code> declaration syntax is
          adopted for postcondition old value declarations however this library deduces
          the type of old value expressions using <a href="http://www.boost.org/doc/libs/release/libs/typeof" target="_top">Boost.Typeof</a>
          so no <a href="http://en.wikipedia.org/wiki/C%2B%2B11" target="_top">C++11</a>
          feature is actually needed (in this case programmers can optionally specify
          the old value type so to not use <a href="http://www.boost.org/doc/libs/release/libs/typeof" target="_top">Boost.Typeof</a>
          as explained in the <a class="link" href="advanced_topics.html" title="Advanced Topics">Advanced
          Topics</a> section).
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.postconditions__result_and_old_values_.f1" href="#contract__.tutorial.postconditions__result_and_old_values_.f1" class="para">22</a>] </sup>
          <span class="bold"><strong>Rationale.</strong></span> This is also the syntax specified
          by <a class="link" href="bibliography.html#N1962_anchor">[N1962]</a> for the <code class="computeroutput"><span class="keyword">oldof</span></code>
          operator which is the equivalent of the <code class="computeroutput"><span class="identifier">CONTRACT_OLDOF</span></code>
          macro.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.postconditions__result_and_old_values_.f2" href="#contract__.tutorial.postconditions__result_and_old_values_.f2" class="para">23</a>] </sup>
            <span class="bold"><strong>Rationale.</strong></span> This library macros could
            have been implemented to allow to mix the order of some tokens (preconditions
            and postconditions, <code class="computeroutput"><span class="keyword">volatile</span></code>
            and <code class="computeroutput"><span class="keyword">const</span></code>). However, that
            would have complicated the macro implementation without any added functionality
            for the user.
          </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.classes_and_class_invariants.f0" href="#contract__.tutorial.classes_and_class_invariants.f0" class="para">24</a>] </sup>
          <span class="bold"><strong>Rationale.</strong></span> There is no need for a <code class="computeroutput"><span class="identifier">CONTRACT_STRUCT</span></code> macro because this library
          macros can parse the class declaration and distinguish between the <code class="computeroutput"><span class="keyword">struct</span></code> and <code class="computeroutput"><span class="keyword">class</span></code>
          specifiers.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.classes_and_class_invariants.f1" href="#contract__.tutorial.classes_and_class_invariants.f1" class="para">25</a>] </sup>
            <span class="bold"><strong>Rationale.</strong></span> The authors have not fully
            investigated if this library could be extended to specify contracts for
            unions. It is possible that future revisions of this library will support
            contracts for unions (see also <a href="http://sourceforge.net/apps/trac/contractpp/ticket/50" target="_top">Ticket
            50</a>).
          </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.constructors.f0" href="#contract__.tutorial.constructors.f0" class="para">26</a>] </sup>
          <span class="bold"><strong>Rationale</strong></span> This library needs to know each
          member access level because in Contract Programming only public members
          are supposed to check class invariants while protected and private members
          only check preconditions and postconditions but not the class invariants.
          Unfortunately, in C++ it is not possible for a member to introspect its
          access level using template meta-programming. Therefore, this library requires
          the access level to be specified within the macros and it uses preprocessor
          meta-programming to detect it. Furthermore, given that the access level
          is has to be specified, the <code class="computeroutput"><a class="link" href="../CONTRACT_FUNCTION.html" title="Macro CONTRACT_FUNCTION">CONTRACT_FUNCTION</a></code>
          macro also uses it to differentiate between free and member functions so
          no additional macro <code class="computeroutput"><span class="identifier">CONTRACT_MEMBER</span></code>
          is needed.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.constructors.f1" href="#contract__.tutorial.constructors.f1" class="para">27</a>] </sup>
          <span class="bold"><strong>Rationale.</strong></span> Member initializers are specified
          after the preconditions and postconditions because they are part of the
          constructor definition while preconditions and postconditions are part
          of the constructor declaration.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.destructors.f0" href="#contract__.tutorial.destructors.f0" class="para">28</a>] </sup>
          Future revisions of this library might implement static postconditions
          for destructors (see the <a class="link" href="contract_programming_overview.html#contract__.contract_programming_overview.destructor_calls" title="Destructor Calls">Destructor
          Calls</a> section).
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.inheritance_and_subcontracting.f0" href="#contract__.tutorial.inheritance_and_subcontracting.f0" class="para">29</a>] </sup>
            <span class="bold"><strong>Rationale</strong></span>. In this case, the library
            implementation will recursively check contracts of the overriding function
            forever (in all other cases, this library is able to avoid infinite recursions
            due to contract checking).
          </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.class_templates.f0" href="#contract__.tutorial.class_templates.f0" class="para">30</a>] </sup>
            <span class="bold"><strong>Rationale.</strong></span> The library must know if
            the enclosing scope is a template so it knows when to prefix nested type
            expressions with <code class="computeroutput"><span class="keyword">typename</span></code>
            (because <a href="http://en.wikipedia.org/wiki/C%2B%2B" target="_top">C++03</a>
            does not allow to use <code class="computeroutput"><span class="keyword">typename</span></code>
            outside templates). This constraints could be relaxed on future revisions
            of this library for <a href="http://en.wikipedia.org/wiki/C%2B%2B11" target="_top">C++11</a>
            compilers (because <a href="http://en.wikipedia.org/wiki/C%2B%2B11" target="_top">C++11</a>
            allows to use <code class="computeroutput"><span class="keyword">typename</span></code> more
            freely). Earlier versions of this library did not require to use the
            special <code class="computeroutput"><span class="identifier">_TPL</span></code> macros within
            templates because the library internally implemented every contracted
            function using a template function, possibly with dummy template parameters,
            even if the original function was not a template so <code class="computeroutput"><span class="keyword">typename</span></code>
            could always be used by the library. The dummy template parameters were
            hidden to the user so this approach did not change the user API and had
            the benefit of not requiring the <code class="computeroutput"><span class="identifier">_TPL</span></code>
            macros. However, this approach increased compilation time because of
            the extra templates that it introduced so the current revision of the
            library uses the <code class="computeroutput"><span class="identifier">_TPL</span></code>
            macros.
          </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.forward_declarations_and_body_definitions.f0" href="#contract__.tutorial.forward_declarations_and_body_definitions.f0" class="para">31</a>] </sup>
          In principle, this library supports <code class="computeroutput"><span class="keyword">export</span></code>
          templates that can be used to program template definitions separately from
          their declarations and in files that can be pre-compiled. However, <code class="computeroutput"><span class="keyword">export</span></code> templates are not supported by most
          <a href="http://en.wikipedia.org/wiki/C%2B%2B" target="_top">C++03</a> compilers
          (in fact, <a href="http://www.comeaucomputing.com/4.0/docs/userman/export.html" target="_top">Comeau</a>
          might be the only compiler that supports them), they were removed from
          <a href="http://en.wikipedia.org/wiki/C%2B%2B11" target="_top">C++11</a>, and
          they are an untested feature of this library. Instead of using <code class="computeroutput"><span class="keyword">export</span></code> templates, it is common practise
          in C++ to program both template declarations and definitions together so
          they can be compiled correctly. In this example, the authors have used
          a separate header file <code class="computeroutput"><span class="special">...</span><span class="identifier">_impl</span><span class="special">.</span><span class="identifier">hpp</span></code> to logically separate template declarations
          and definitions but the header is included at the bottom of the declaration
          header file so the definitions are always available together with their
          declarations.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.forward_declarations_and_body_definitions.f1" href="#contract__.tutorial.forward_declarations_and_body_definitions.f1" class="para">32</a>] </sup>
          <span class="bold"><strong>Rationale.</strong></span> Four different body macros
          are needed because contracts are disabled differently for the different
          type of functions. For example, disabling preconditions and postconditions
          turns off contracts for free functions but not for member functions, disabling
          class invariants turns off contracts for destructors but not for constructors,
          etc.
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.forward_declarations_and_body_definitions.f2" href="#contract__.tutorial.forward_declarations_and_body_definitions.f2" class="para">33</a>] </sup>
          Some compilers accept to repeat template parameter names in the constructor
          and destructor names. However, this is not <a href="http://en.wikipedia.org/wiki/C%2B%2B" target="_top">C++03</a>
          compliant (and, for example, it was fixed in more recent versions of GCC)
          therefore programmers are advised to specify the template parameter names
          only for the class type and not for the constructor and destructor names
          (this is also why the macros must take a second parameter with the class
          name instead of just the class type parameter).
        </p></div>
<div class="footnote"><p><sup>[<a id="ftn.contract__.tutorial.forward_declarations_and_body_definitions.f3" href="#contract__.tutorial.forward_declarations_and_body_definitions.f3" class="para">34</a>] </sup>
            <span class="bold"><strong>Rationale.</strong></span> This limitation comes from
            the fact that <a href="http://en.wikipedia.org/wiki/C%2B%2B" target="_top">C++03</a>
            does not support delegating constructors. If member initializers are
            specified within the contract, the deferred body will not compile when
            contract compilation is turned off by the configuration macros. If instead
            member initializers are specified with the deferred body definition,
            the deferred body will not compile when contract compilation is turned
            on by the configuration macros. There is no way to reconcile these two
            conditions without delegating constructors, so definitions cannot be
            deferred for constructors that specify member initializers. This limitation
            could be removed in future revisions of this library for <a href="http://en.wikipedia.org/wiki/C%2B%2B11" target="_top">C++11</a>
            compilers that support delegating constructors (see also <a href="http://sourceforge.net/apps/trac/contractpp/ticket/51" target="_top">Ticket
            51</a>).
          </p></div>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2008-2012 Lorenzo Caminiti<p>
        Distributed under the Boost Software License, Version 1.0 (see accompanying
        file LICENSE_1_0.txt or a copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="contract_programming_overview.html"><img src="../../..//doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../..//doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../..//doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="advanced_topics.html"><img src="../../..//doc/src/images/next.png" alt="Next"></a>
</div>
</body>
</html>
